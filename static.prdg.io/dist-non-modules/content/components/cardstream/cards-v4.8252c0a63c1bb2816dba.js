if("undefined"==typeof sbGlbl&&(sbGlbl={}),"undefined"==typeof sbCards&&(sbCards={}),"object"!=typeof sbGlbl.objCards&&(sbGlbl.objCards={}),void 0===sbPage)var sbPage={};"object"==typeof streams&&(sbPage.boolHasTrays=!0),"undefined"==typeof specificStream&&(specificStream=sbCards.specificStream),"undefined"==typeof cardHash?cardHash=sbCards.cardHash:specificStream&&(sbPage.boolIsViewAll=!0);var LINK_SOURCE_HOMEPAGE="1",ANSWER_TRAY=9,NCRAVE_TRAY="boolean"==typeof sbGlbl.isHome&&sbGlbl.isHome?145:13,NCRAVE_BET_TRAY=156,FEATURE_TRAY=16,FAVORITES_TRAY=18,DISCOVER_FEATURED_TRAY=120,FRONTEND_OFFERS="boolean"==typeof sbGlbl.isHome&&sbGlbl.isHome?563:501,EDITORS_PICK_TRAY=138,OFFER_UNAVAILABLE=157,FEATURED_REWARDS=155;function stripHtml(e){var a=document.createElement("DIV");return a.innerHTML=e,a.textContent||a.innerText||""}sbGlbl.streamsMetadata=[];var cardProps={maxPartialRenderNotInitial:50,cardDeckSelector:"cardDeck",cardWrapperId:"string"!=typeof sbGlbl.cardWrapperIdOverride?"cardDeck":sbGlbl.cardWrapperIdOverride,cardsPageWrapperId:"earningCardsWrap",cardsPagePrimaryAlternativeWrapperId:"main",cardsPageSecondaryAlternativeWrapperId:"mainNavCont",cardId:"sbHomeCard",cardContentWrapClass:"sbHomeCardContent",cardImgWrap:"sbHomeCardImg",cardBlurWrap:"sbHomeCardImgBlur",cardClass:"sbHomeCard",cardListViewSelector:"sbShopListViewStore",cardListViewStoreDescriptionSelector:"sbShopListViewStoreDescription",traySelector:"sbTray",trayTitleLinkClass:"sbTrayTitleLink",trayControlDisabledClass:"sbHCTNavNull",cardImgContainerId:"sbTrayListItemHeader",cardImgContainerSelector:"sbTrayListItemHeaderImgContainer",cardSubImgContainerClass:"sbTrayListItemHeaderImgSubContainer",cardImgBlurId:"cardContentImgBlur",cardHeaderId:"cardHeader",cardActionBtnClass:"cardActionBtn",cardTypeNameId:"cardTypeName",cardEarnContainerClass:"sbTrayListItemSbEarn",cardEarnContainerNotActiveClass:"notActive",cardEarnWrapId:"cardSBValue",cardEarnAmountId:"cardSBValueAmt",cardStaticPayoutAmountSelector:".sbCardStaticPayoutAmount",cardTextWrapClass:"sbHomeCardText",fullYear:(new Date).getFullYear(),$tooltip:$("#newTooltip"),$doc:$(document),cardImgWrapperElement:"div",cardImgWrapperSelector:"sbCardImgWrapper",cardInfoTooltipWrapId:"hoverDetails",cardInfoTooltipWrapClass:"hoverDetailsCard",cardHoverQuickLookSelector:"sbCardQuickLook",cardHoverQuickLookCtaSelector:"sbCardQuickLookCta",quickLookId:"sbQuickLook",quickLookClass:"sbQuickLookCards",switchTrayClass:"sbQuickLookCardsTrayCta",switchCardClass:"sbCardDetailsSwitchCardCta",cardDetailsContainerSelector:"sbCardDetailsContainer",cardDetailsSelector:"sbCardDetails",currentCardDetailsSelector:"sbCurrentCardDetails",nextCardDetailsSelector:"sbNextCardDetails",prevCardDetailsSelector:"sbPrevCardDetails",cardDetailsClassesToRemove:"sbCurrentCardDetails sbNextCardDetails sbPrevCardDetails",cardDetailsInnerSelector:"sbCardDetailsInner",cardDetailsPrimaryCtaClass:"sbCardDetailsPrimaryCta",cardDetailsSecondaryCtaClass:"sbCardDetailsSecondaryCta",cardDetailsTabClass:"sbCardDetailsInfo",cardDetailsTabsNavClass:"sbCardDetailsInfoNav",cardDetailsTabCtaClass:"sbCardDetailsInfoNavCta",cardDetailsCouponsCtaClass:"sbCardDetailsInfoNavCouponsCta",cardDetailsFavoriteCtaClass:"sbCardDetailsFavoriteCta2",couponCardClass:"sbCouponCard",cardDetailsCouponsTabClass:"sbCardDetailsInfoCoupons",cardDetailsMerchantCouponName:"sbCardDetailsMerchantCouponName",clickableCouponCodeContainerClass:"sbTrayListItemOfferCouponClickable",clickableCouponCodeClass:"sbTrayListItemOfferCouponToCopy",starterCardProps:{cardTypeId:"starterCard"},favoritesTrayNullCaseCardProps:{headerName:"Shop",cardTypeId:"nullCard"},favoritesTrayNullCaseTipsProps:{text:sbHelpers.isMember()?"To add a store to your Favorite Stores, hover on it and click":"To view or add a store to your Favorite Stores, please sign up or log in.",cardTypeId:"favoritesNullCaseTips"},localDealsTrayNullCaseTipsProps:{text:"Sorry, there are currently no deals available for that location.<br/>Please try another zip code.",cardTypeId:"localDealsNullCaseTips"},favoritesTrayPrefilledCaseCardProps:{showTooltip:!0},answerNoInitialProfilerCaseProps:{timeComplete:null,earn:null,headerName:"Answer",cardExamples:[{completeTime:20,surveyId:436746698,award:25},{completeTime:5,surveyId:435346645,award:10},{completeTime:21,surveyId:999995412,award:60},{completeTime:11,surveyId:5465468,award:61}],cardTypeId:"answerNoInitialProfilerCase"},shopListViewStoreDetailsCtaClass:"sbShopListViewStoreDetailsCta",shopListViewStoreCouponsCtaClass:"sbShopListViewStoreCouponsCta",shopListViewStoreMainCtaClass:"sbShopListViewStoreCta",discoverCardDefaultCtaText:"Discover",discoverCardDefaultAboutHeading:"Details",continuePlayingCardClass:"continuePlayingCard",featuredCardClass:"featuredCard",premiumCardClass:"showPremiumBanner",premiumCardsDisplayedClasses:"premiumCardsDisplayed premiumCardsDisplayed",intMerchantCardTypeId:43,intAmazonUsMerchantId:793,intAmazonCaMerchantId:794,intAmazonUkMerchantId:22854,intPublishersClearingHouseMerchantId:11582,intShopCardTypeId:39,intMerchantStoreCardTypeId:43,intCouponCardTypeId:47,intNCraveCardTypeId:41,intWatchCardTypeId:48,intFrontEndCardTypeId:51,intLocalDealCardTypeId:57,intOfferServerPremiumCardTypeId:96,intOfferServerFeaturedCardTypeId:97,intOfferServerStandardCardTypeId:98,intNtfCardTypeId:99,answerCardTypeIds:[16,29,33,34,37,46,50,53,56,62,63,64],intInStoreDealsTypeId:94,answerHeaderClass:"answerCardHeader",answerPromoStarterHeaderClass:"answerPromoStarterHeader",answerPromoStarterHeaderID:"surveyPromoTimer",answerPromoStarterCardTypeId:"answerPromoStarter",nCraveTrayNotReadyClass:"notReady",nCraveCardClass:"cardType41",watchCardClass:"cardType48",watchCardNowPlayingClass:"nowPlayingContainer",watchCardNowPlayingHiddenClass:"nowPlayingHidden",watchCardNowPlayingVisibleClass:"nowPlayingVisible",watchCardPanelBgClass:"sbWatchCardPanelBg",watchCardPanelClass:"sbWatchCardPanel",watchCardVideoTitleClass:"sbCardDetailsVideoTitle",genericCardClass:"sbCard",hiddenCardClass:"hiddenCard",disabledCardClass:"disabledCard",disabledTemporarilyCardClass:"disabledTemporarilyCard",trackableCardClass:"sbCardTrackable",notTrackableCardClass:"sbCardNotTrackable",toutCardClass:"toutCard",fbLikeCardClass:"fbLikeCard",starterCardSelector:"sbStarterCard",doubleWideCardClass:"doubleWideCard",backgroundContentClass:"sbBackgroundContent",viewAllPageTitleId:"sbStreamType",highestPriorityStreamId:-1,firstPageOfCardsCount:5,rewardsCardClass:"sbRewardsCard",searchCardShopNowCtaClass:"sbSearchCardShopNowCta",midPlaceholder:"@MemberID@",publishersClearingHouseCtaText:"Enter to Win",TOP_OFFERS_PAGE_ID:111061,TRUEX:23,traysToLoadAfterPageLoad:sbHelpers.isObject(sbCards.objTrays)&&sbHelpers.isNumeric(sbCards.objTrays.inStoreDeals)?[sbCards.objTrays.inStoreDeals]:[]};10170===sbGlbl.intPageId?cardProps.maxRenderInitial=999:"number"==typeof streamAutoLoadLength?cardProps.maxRenderInitial=streamAutoLoadLength:cardProps.maxRenderInitial=15;var cardDelay=10,showingCards=!1,showingMoreCardsInterval,$cardToSlide,counts=0,curCardTime,loadingMoreCards=!1,scolledCallsCount=0,checkingMoreCardsInterval,noMoreAutoCards=!1,noMoreCards=!1,masterStarted=!1,masterSoCards={},cardHeight=322,$crdsWin=$(window),$cardsBod=$("body"),$filterAndSortContainer=$("#filterSortContainer"),successfulPseudoCardCache={},hiddenCardTimers=[],successfulPseudoCardCollection=$(),isFirstSort=!0,sortTypeNameMap=["Highest Payout","Lowest Payout","Most Recent","Most Popular"],createdSpinner=!1,GW_URL_QUERY_PARAM="/?gw=1";function loadMoreOnScroll(){!noMoreCards&&$("#sbStreamLoadMoreCtaWrap").isOnScreen()&&loadMoreManual()}function shortenText(e,a,r){if(!e)return"";r=r||!1,a=a||260;if(e.length>a){if(!/\s/.test(e.charAt(a)))for(var t=0;!/\s/.test(e.charAt(a))&&t<=100;)a--,t++;return e.substring(0,a)+(r?"":'<span class="isTooltipTrigger cardEllipses" data-tooltip-content="'+sbHelpers.encodeHtml(e.substring(a,e.length))+'">&hellip;</span>')}return e}function cardScrolled(){noMoreCards||noMoreAutoCards||scolledCallsCount>5||filteringOrSortingCards||(loadingMoreCards?checkLaterForMoreCards():$(window).scrollTop()+$(window).height()+cardHeight>$("#colMain").height()&&(loadMoreCards(!0),scolledCallsCount++))}function checkLaterForMoreCards(){clearInterval(checkingMoreCardsInterval),checkingMoreCardsInterval=setInterval((function(){cardScrolled()}),500)}function loadMoreManual(){filteringOrSortingCards||loadMoreCards(!1)}function checkDisplayedMB(){return $(".sbHomeCard.answerCard.cardType"+cardsInfo.typeIds.mb).length>0}function getCards(e,a,r){if(Boolean(sbHelpers.isTrayMobileViewV2Applicable()&&(sbHelpers.isViewport("tiny")||sbHelpers.isViewport("narrow"))))sbCards.renderCardsMobileViewV2(initialCardLoad.streamID,{renderHeader:!1});else{var t=sbGlbl.objNCravePlacements,s=void 0!==t&&"boolean"==typeof t.readyToRender,d=s&&"boolean"==typeof t.isWatchViewAll&&t.isWatchViewAll&&void 0!==t.nCraveCards,o=s&&"boolean"==typeof t.isSponsoredHome&&t.isSponsoredHome&&void 0!==t.frontEndNcraveCards;if(!d||t.readyToRender){var i,n=[],l=[],c=-1,C=e,p=cardsInfo.cards.length,u=document.createDocumentFragment(),f=!1;if("boolean"!=typeof sbGlbl.isWatchCategory||!sbGlbl.isWatchCategory||p){for(sbGlbl.isListView&&void 0===sbGlbl.objCards.arrFirstCharacterNavigation&&(sbGlbl.objCards.arrFirstCharacterNavigation=[]),a&&p>cardProps.maxRenderInitial?(p=cardProps.maxRenderInitial,i=p):0!==e&&!a&&p-e>cardProps.maxPartialRenderNotInitial&&(p=e+cardProps.maxPartialRenderNotInitial,i=p),curCardTime=(new Date).getTime();C<p;C++){if(g=cardsInfo.cards[C],$.inArray(g.cardTypeId,cardsInfo.typeIds.soMaster)>-1)void 0===(h=successfulPseudoCardCache[g.cardId])?masterSoAddCard(g):appendPseudoCardFromCache(h.card,g.trkId)}var b=initialCardLoad.showTooltip;if(!sbGlbl.isListView&&p){var m=initialCardLoad.streamID;m===FAVORITES_TRAY&&"boolean"==typeof b&&b?createCard($.extend({},cardProps.favoritesTrayNullCaseCardProps,cardProps.favoritesTrayPrefilledCaseCardProps)):"object"!=typeof initialCardLoad.streamIntro||sbGlbl.objCards.hadCardBeenClosed(cardProps.starterCardSelector+m)||sbCards.trayMobileViewV2Possible||!sbGlbl.objCards.getCardsWrapper().length||createCard($.extend({trayId:m,strChannel:initialCardLoad.channel||"",strAllUrl:initialCardLoad.allUrl||""},initialCardLoad.streamIntro,cardProps.starterCardProps))}for(C=e;C<p;C++)if(c++,g=cardsInfo.cards[C],$.inArray(g.cardTypeId,cardsInfo.templatedVirtual)>-1){if(g.cardId in failedPseudoCardCache)continue;var h;void 0===(h=successfulPseudoCardCache[g.cardId])?createVirtualCard(g):appendPseudoCardFromCache(h.card,g.trkId)}else if(!sbGlbl.isListView&&$.inArray(g.cardTypeID,[15,16])>-1&&specificStream){var g;16==(g=$.extend(g,{trayId:specificStream})).cardTypeID?n.push(g):15==g.cardTypeID&&l.push(g)}else{if(sbGlbl.isListView){var I=g.header.charAt(0);I=isNaN(I)?I.toUpperCase():"#",-1===sbGlbl.objCards.arrFirstCharacterNavigation.indexOf(I)&&sbGlbl.objCards.arrFirstCharacterNavigation.push(I),g.strCardFirstCharacter="#"!==I?I:"NUM"}var y=createCard(g,void 0,void 0,!0);if(!y)continue;u.appendChild(y[0]),f=!0}if(f){if(d)$(u).children().filter("."+cardProps.nCraveCardClass).length?t.nCraveCards=$(u).children().clone(!0,!0):t.playlistCards=$(u).children().clone(!0,!0);var v=$(u),S=v.children();if(o&&t.readyToRender)return void(t.frontEndNcraveCards=S);v.appendTo("#"+cardProps.cardWrapperId),sbGlbl.isListView&&sbHelpers.truncate(sbCards.getCardDeck().find("."+cardProps.cardListViewStoreDescriptionSelector),sbCards,"intStoreDescriptionLineHeight",3)}var T="#"+cardProps.cardWrapperId,P=$(T);(specificStream==FEATURE_TRAY||specificStream==DISCOVER_FEATURED_TRAY||specificStream==OFFER_UNAVAILABLE)&&sbGlbl.premiumAndFeaturedCards.featured.length&&a&&A(sbGlbl.sbHomeAd.createFeaturedCards(sbGlbl.premiumAndFeaturedCards.featured,!0,initialCardLoad.channel),!0),l.length&&A(sbGlbl.sbHomeAd.createFeaturedCards(l,!1,initialCardLoad.channel),!0),(specificStream==FEATURE_TRAY||specificStream==DISCOVER_FEATURED_TRAY||specificStream==OFFER_UNAVAILABLE)&&sbGlbl.premiumAndFeaturedCards.premium.length&&a&&A(sbGlbl.sbHomePremiumBanner.createPremiumBanners(sbGlbl.premiumAndFeaturedCards.premium,specificStream,!0,initialCardLoad.channel)),n.length&&A(sbGlbl.sbHomePremiumBanner.createPremiumBanners(n,specificStream,!1,initialCardLoad.channel)),c>-1?showCards(e,c,a,r):specificStream&&specificStream===FAVORITES_TRAY&&showNullCase(3,!0),a&&updateCardsRealCount(cardsInfo.cards.length),sbGlbl.showAlphaList&&"function"==typeof createNavigationByFirstCharacter&&createNavigationByFirstCharacter(),"number"==typeof i&&setTimeout((function(){getCards(i,!1)}),50),sbCards.boolUseQuickLook&&sbCards.initQuickLookMobile()}else location.href=window.location.origin+"/watch/unavailable"}}function w(e){if(!e){var a=P.children("."+cardProps.premiumCardClass),r=a?a.length:0;r>0&&sbGlbl.objCards.getCardsWrapper().addClass(cardProps.premiumCardsDisplayedClasses+r)}}function A(e,r){r="boolean"==typeof r&&r,a?e.prependTo(T).promise().done((function(){w(r)})):P.children("."+(r?cardProps.featuredCardClass:cardProps.premiumCardClass)).last().after(e).promise().done((function(){w(r)}))}}function disableCard(e,a,r){r="boolean"==typeof r&&r;var t=cardProps.disabledTemporarilyCardClass;if("boolean"!=typeof a||!a){var s=e.closest("."+cardProps.traySelector),d=e.tmplItem().data,o=d.trayId;s.triggerHandler("cardToBeDisabled",[e]),e.remove().promise().done((function(){s.triggerHandler("cardDisabled"),!specificStream&&o&&o==cardProps.highestPriorityStreamId&&sbCards.refreshDuplicateCheck(d)})),t=cardProps.disabledCardClass}e.length&&e.toggleClass(t,!r)}function extendFrontEndCardData(e){switch(-1!=[e.trayId,specificStream].indexOf(FRONTEND_OFFERS)&&e.upTo&&(e.upTo=!1),e.relatedID){case 26:e.pseudoCardType="jun",e.earn=junSBAmount;break;case 58:e.pseudoCardType="buzz";break;case 137:case-2:case-4:e.pseudoCardType="ngage";break;case 78:case-3:e.pseudoCardType="daniel";break;case 35:e.headerName="Answer",e.cardIcon="answer",e.pseudoCardType="peanut";break;case 234:e.pseudoCardType="screenrush"}}function createCard(e,a,r,t){var s=e.cardTypeId,d="number"==typeof s,o=void 0===sbGlbl.cardTmplOverride?s:sbGlbl.cardTmplOverride,i=cardsInfo.templates[o];if(sbCards.isAnswerCardV2Applicable(r)){if(null===e||s===cardProps.intOfferServerStandardCardTypeId||s===cardProps.starterCardProps.cardTypeId)return!1;i=s===cardProps.answerPromoStarterCardTypeId?sbCards.answerCardV2PromoTmpl:sbCards.answerCardV2Tmpl}if(void 0===i)return!1;var n,l=$.extend(e,cardsInfo.cardAdditionalData[s]),c=l.cardTypeId,C=s==cardProps.intNtfCardTypeId;specificStream&&(r=specificStream,l.strChannel=initialCardLoad.channel||""),a=a||!1,!C||14!=e.iconType&&24!=e.iconType||(l=$.extend(l,ntfCardTypes[e.iconType])),!0===l.perDollar&&l.earn&&!sbHelpers.isNumeric(l.cashBackPercent)&&(l.cashBackPercent=sbCards.calculateCashBackPercent(l.earn)),s!=cardProps.intFrontEndCardTypeId&&c!=cardProps.intFrontEndCardTypeId||extendFrontEndCardData(l);var p=sbGlbl.getCardsLocation(),u=sbCards.swagUpShopPromo;l.currencyName=p.currencyName.toLowerCase(),l.currencySymbol=p.currencySymbol,l.currentLocationId=p.locationID,l.boolIsCardTypeIdNumeric=d,l.boolIsShopCard=d&&s===cardProps.intShopCardTypeId,l.boolIsShopCardSwagUpPromo=l.boolIsShopCard&&!(l.discoverChannel||0===l.earn)&&"object"==typeof u&&"boolean"==typeof u.active&&u.active,l.boolIsMerchantStoreCard=d&&s===cardProps.intMerchantStoreCardTypeId,l.boolIsCouponCard=d&&s===cardProps.intCouponCardTypeId,l.boolIsWatchCard=d&&s===cardProps.intWatchCardTypeId,l.boolIsNcraveCard=d&&s===cardProps.intNCraveCardTypeId,l.boolIsAnswerCard=l.isAnswerCard||d&&cardProps.answerCardTypeIds.indexOf(s)>-1,l.boolIsAnswerCardBonus=l.boolIsAnswerCard&&"boolean"==typeof sbCards.answerPromoShouldBeDisplayed&&sbCards.answerPromoShouldBeDisplayed&&"number"==typeof sbCards.answerPromoMultiplier&&sbCards.answerPromoMultiplier>0,l.boolIsAnswerCardPromo=l.boolIsAnswerCardBonus&&(void 0===sbCards.answerPromoShouldBeAddedToBaseAmount||!sbCards.answerPromoShouldBeAddedToBaseAmount),l.boolIsAnswerCardBonusExpiration=l.boolIsAnswerCardBonus&&void 0!==sbCards.answerPromoExpirationShouldBeShown&&sbCards.answerPromoExpirationShouldBeShown,l.boolIsAnswerSurveyAwardRangeShown=sbCards.showSurveyAwardRange,l.boolIsContinuePlayingCard=d&&s===cardProps.intOfferServerStandardCardTypeId&&void 0!==l.continuePlayingData,l.answerPromoBonus=0,l.boolIsAnswerPromoBonusShown=!1,l.hasNcraveTrayRedesign=l.boolIsNcraveCard&&void 0!==sbGlbl.objNCravePlacements&&"boolean"==typeof sbGlbl.objNCravePlacements.hasNcraveHpRedesign&&sbGlbl.objNCravePlacements.hasNcraveHpRedesign,l.shouldSkipOfferModal="boolean"==typeof sbCards.shouldSkipOfferModal&&sbCards.shouldSkipOfferModal,l.boolIsImageUrlFinal=(l.boolIsWatchCard||l.boolIsNcraveCard)&&"string"==typeof l.image&&""!==l.image&&l.image.indexOf(".vidible.tv")>-1,(l.boolIsWatchCard||l.hasNcraveTrayRedesign)&&"number"!=typeof l.size&&(l.size=0),l.hasNcraveTrayRedesign&&"string"!=typeof l.linkType&&(l.linkType="link"),l.boolIsNcraveCard&&!l.earn&&(l.earn="?"),l.boolIsAnswerCard&&(void 0!==l.bonus?(l.earn=l.displayedPayoutAmount,l.answerPromoBonus=l.bonus,l.boolIsAnswerPromoBonusShown=l.shouldDisplayBonus,l.boolIsAnswerPromoBonusShown&&(l.caption="Limited Time Bonus SB")):(l.boolIsAnswerCardPromo&&(l.caption="Limited Time Bonus SB",l.answerPromoBonus=Math.round(l.earn*sbCards.answerPromoMultiplier)),l.boolIsAnswerCardBonus&&l.earn&&(sbCards.answerPromoShouldBeAddedToBaseAmount?l.earn+=l.answerPromoBonus:sbCards.answerPromoShouldBeSubtractedFromBaseAmount&&(l.earn-=l.answerPromoBonus)),l.answerPromoMultiplier=sbCards.answerPromoMultiplier,l.boolIsAnswerPromoBonusShown=l.boolIsAnswerCardPromo&&l.answerPromoBonus>=1)),l.boolIsShopCard&&l.boolIsShopCardSwagUpPromo&&(l.caption=sbCards.swagUpShopPromoTemplate),l.merchantId&&l.merchantId===cardProps.intPublishersClearingHouseMerchantId&&(l=sbCards.extendDataCtaPropText(l,cardProps.publishersClearingHouseCtaText)),l.boolUseQuickLook=sbCards.shouldUseQuickLookModal(l),Boolean(window.specificStream)||!l.boolIsMerchantStoreCard||r!==sbCards.objTrays.amazonStoreUS&&r!==sbCards.objTrays.amazonStoreCA||(sbCards.changeAmazonCardLinks(l),sbCards.changeAmazonCardSubheader(l));var f=l.earn;if(l.earnValue=sbCards.getEarnValue(f),(l.boolIsShopCard||l.boolIsMerchantStoreCard||l.boolIsCouponCard)&&f){var b=l.origEarn,m=void 0!==b;l.boolIsShopCard&&(l.boolIsPromotion=m&&(l.floatPromotionFactor=f/b)>1&&f%b==0),"boolean"==typeof l.perDollar&&l.perDollar?(l.intCashBack=l.cashBackPercent,l.strCash=l.cashBackPercent+"%",m&&b<f&&(l.intOrigCashBack=l.origCashBackPercent,l.strOrigCash=l.origCashBackPercent+"%")):(l.strCashValue=l.sbCashValueFormatted,l.strCash=sbHelpers.formatCurrencyNumber(l.sbCashValueFormatted,{},sbGlbl.getCardsLocation()),m&&b<f&&(l.strOrigCashValue=l.origSbCashValueFormatted,l.strOrigCash=sbHelpers.formatCurrencyNumber(l.sbCashValueFormatted,{},sbGlbl.getCardsLocation())))}l.boolIsContinuePlayingCard&&l.continuePlayingData&&(l.goalHeader=l.continuePlayingData.header,l.daysRemaining=1===l.continuePlayingData.daysRemaining?"Less than 1 day left to:":l.continuePlayingData.daysRemaining+" days left to:"),l.shorterEarnCopyApplicable=sbGlbl.intPageId===cardProps.TOP_OFFERS_PAGE_ID&&d&&(s===cardProps.intOfferServerStandardCardTypeId||s===cardProps.intNtfCardTypeId);var h="coupon=",g=l.link,I=g?g.indexOf(h):-1;if(-1!==I&&(l.intCouponId=g.slice(I+h.length)),l.skipDuplicates&&doesCardAlreadyExist(l.cardId,r))return updateCardsRealCount(getCardsRealCount()-1),!1;if(l=sbCards.setCaptionLines(l),specificStream?($.extend(l,{trayId:r,realCardId:l.cardId}),n=$.tmpl(i,l),"boolean"!=typeof t&&n.appendTo("#"+cardProps.cardWrapperId),$.extend(l,{$card:n,cardId:createNewCardId(l.cardId,r)})):(n=$.tmpl(i,l),$.extend(l,{$card:n,realCardId:l.cardId,trayId:r,cardId:createNewCardId(l.cardId,r)})),n.hasClass("disabledCard"))return disableCard(n);if(l.offerWallID===cardProps.TRUEX&&n.addClass("truexCard"),specificStream&&l.customTmplFn&&"function"==typeof window[l.customTmplFn]&&window[l.customTmplFn](l,n),specificStream||!l.isHiddenCard&&!a||51==c||59==c){var y=cardsInfo.cardFunctions[c];void 0!==y&&y(l.cardId,void 0,l)}return n.data($.extend(n.data(),l)),n}function createAndAddCard(e,a,r,t){var s=createCard(e,a,r);return s&&t?t.add(s):t}function createNewCardId(e,a){return e+"-"+a}function createVirtualCard(e){createCard(e,!0)}function generateCardLink(e,a,r,t){var s=e.merchantId,d=e.cardTypeId,o=e.trayId,i=e.integrationTypeID,n=sbHelpers.isMember(),l=e.isSuppressModal,c=[cardProps.intAmazonUsMerchantId,cardProps.intAmazonCaMerchantId,cardProps.intAmazonUkMerchantId],C=!n&&(sbHelpers.isNumeric(s)&&!c.includes(s)||sbHelpers.isNumeric(d)&&d===cardProps.intMerchantCardTypeId||110001<=sbGlbl.intPageId&&sbGlbl.intPageId<=110012||1==sbCards.specialOfferCard||101329===sbGlbl.intPageId||sbGlbl.intPageId===cardProps.TOP_OFFERS_PAGE_ID||sbHelpers.isObject(sbCards.objTrays)&&o===sbCards.objTrays.allDiscoverOffers)&&!sbPage.boolIsShopAllStoresListView;if(C&&$cardInfoTipWrap&&$cardInfoTipWrap.hide(),sbCards.isGlobalSearch&&!C){var p=t.target,u=p.classList,f="searchCardLink",b=p.closest(".searchCardLink");if(u.contains(f)||p.parentNode.classList.contains(f)||sbHelpers.isElementDescendantOfParent(b,p))return void window.location.assign(p.href||b.href)}if(!e||!isNotExpired(e.cardId))return!1;if(e.clickFnCustom&&"function"==typeof window[e.clickFnCustom]&&!C){if(window[e.clickFnCustom](e))return!1}else if(e.clickFnSoNewWinPop&&!C)soOpenWin(getCardById(e.cardId));else{var m,h,g=sbPage.boolIsShopAllStoresListView;if(!sbCards.shouldUseOfferModalInsteadOfFlyout(d,o,i,l,e.earn)){e.targetBlank&&!C?sbHelpers.isAppm()?window.location.href=e.link:m=window.open(""):m=window,sbHelpers.isUndefined(m)&&(m=window);var I=Boolean(g)&&a&&!e.buttonSdkToBeUtilized;I&&(t&&t.preventDefault(),h=window.open(""))}var y="",v="",S=e.osOverrideLink||e.detailsLink,T=sbCards.extendLinkWithTrayId(e).link;if(e.boolIsShopCard&&(!a&&!sbCards.isShopSearch&&(r||sbCards.boolTreatAllClicksAsShopNowCta||!sbCards.isGlobalSearch)&&(!g||n)||a&&(sbCards.isGlobalSearch&&sbCards.boolTreatShopNowCtaDifferently&&!r||g&&n))&&sbHelpers.isNonEmptyString(S))y=S,I&&a&&sbHelpers.isNonEmptyString(T)&&(v=T);else if(sbHelpers.isNonEmptyString(T))if(y=sbHelpers.isNonEmptyString(S)?S:T,g&&a)y=S,v=sbHelpers.updateQueryString("drctLink",2,T);else for(var P=document.getElementsByClassName("sbTrayListItemGoToCta"),w=P.length,A=0;A<w;A++)P[A].removeAttribute("target");else e.couponId&&(y="/p/coupons?cou="+e.couponId);var k=e.appendToLink;if(k&&!e.buttonSdkToBeUtilized){var D=y.includes("?")?"&":"?",L=e.boolPrefixAppendToLink;if(sbHelpers.isBoolean(L)&&!L&&(D=""),y+=D+k,sbHelpers.isNonEmptyString(v)){var $=e.objAppendToLink;if(sbHelpers.isObject($))for(var H in $)$.hasOwnProperty(H)&&(v=sbHelpers.updateQueryString(H,$[H],v))}}if(e.featuredOrPremiumFinalTargetUrl&&!C)m.location=e.featuredOrPremiumFinalTargetUrl;else{e.dontDecodeLink?(y=encodeURIComponent(y),sbHelpers.isNonEmptyString(v)&&(v=encodeURIComponent(v))):(y=encodeURIComponent(decodeURIComponent(y)),sbHelpers.isNonEmptyString(v)&&(v=encodeURIComponent(decodeURIComponent(v))));var N="";if(N=sbCards.isGlobalSearch?sbCards.getWebSearchCardOrFlyoutClickUrl({tmplItem:e,strTab1FinalUrl:y,boolIsFlyoutClick:r,event:t}):sbCards.generateCardClickUrl(e,y),C&&!sbCards.shouldUseOfferModalInsteadOfFlyout(e.cardTypeId,e.trayId,i,l,e.earn)&&!sbCards.isShopSearch&&!sbCards.isGlobalSearch)return sbCards.redirectOnCardClick(e.cardTypeId,N),!1;var O={tmplItem:e,strTab1CardClickURL:N,tab1:m,tab2:h,boolUseTab2:I,strTab2FinalUrl:v};sbCards.shouldUseOfferModalInsteadOfFlyout(e.cardTypeId,e.trayId,i,l,e.earn)?sbCards.handleOfferModal({cardData:e,event:t,redirectUrl:N}):window.setTimeout(sbCards.handleTabsOnCardClick.bind(null,O),100)}closeCardOnOpenFn(getCardById(e.cardId))}e.callVirtualClicked&&virtualCardClicked(getCardById(e.cardId),!1);var F=getCardById(e.cardId);return!sbCards.boolUseQuickLook&&sbCards.shouldUseFlyout(F)&&hideTipForCard(F),!1}function isNotExpired(e){return!getCardById(e).hasClass("cardExpired")}function getCardById(e,a){var r=sbGlbl.isListView?cardProps.cardListViewSelector:cardProps.cardId,t=$("#"+r+e);return t.length||"object"!=typeof a||(t=a.$card),t}function showNullCase(e,a,r,t){var s=$();if("boolean"==typeof a&&a){sbGlbl.isListView?(sbGlbl.cardTmplOverride="shopFavoritesListViewNullCase",e=1):s=createAndAddCard(cardProps.favoritesTrayNullCaseTipsProps,!1,FAVORITES_TRAY,s);for(var d=0;d<e;d++)s=createAndAddCard(cardProps.favoritesTrayNullCaseCardProps,!1,FAVORITES_TRAY,s);var o=$("#favoriteStoresNav");o.length&&o.hide("fast")}else for(d=0;d<e;d++)s=createAndAddCard(cardProps.favoritesTrayNullCaseCardProps,!1,sbCards.objTrays.inStoreDeals,s);if(void 0!==r&&r.triggerHandler("cardsAdded",s),"boolean"==typeof t&&t)return s}function handleCloseCard(e){e.pseudoCardType?hideOfferProvider(e.pseudoCardType,e.cardId):e.ntf?nftClosed(e.cardId):e.cardTypeId===cardProps.starterCardProps.cardTypeId?sbGlbl.objCards.closeCardRememberOnClient(e):hideCardX(e.cardId),updateCardPositions(e)}function hideCard(e,a){var r=e.tmplItem().data.trayId,t="sbInStoreCard"+sbCards.objTrays.shopAndEarn;if(r!==sbCards.objTrays.shopAndEarn||2!==e.length||e.get(1).id!==t)sbGlbl.sbHome.animateCloseCard(e,(function(){updateCardsRealCount(getCardsRealCount()-1),removeCardFromPseudoCardCache(e.cardId),specificStream?specificStream===FAVORITES_TRAY&&"function"==typeof a&&a():Trays.get(r).removeItem(e,a)}));else{var s=e.get(0);updateCardsRealCount(getCardsRealCount()-1),removeCardFromPseudoCardCache(s.cardId),s.remove(),Trays.get(r).refresh()}}function hideCardX(e){var a=getCardById(e),r=a.tmplItem().data,t=99==r.cardTypeId?r.extraParms:"";$.get("/?cmd=card-jx-hide&card_id="+r.realCardId+"&trkId="+r.trkId+t),hideCard(a),setTimeout(trackCardsInView,1e3)}function hideOfferProvider(e,a){hideCard(getCardById(a),!0),pSetCookie("h"+e,"1",1)}function nftClosed(e){var a=getCardById(e);hideCard(a);var r=a.data("closeUrl");$.post(r)}function createVirtualDefStr(e){var a=e.virtualDef;if(a)return e.column+"@fd@"+e.row+"@fd@"+a.cardTypeId+"@fd@"+e.accuratePos+"@fd@"+a.offerId+"@fd@"+a.cardText+"@fd@"+a.trkId+"@fd@"+a.cardUrl}function addToVirtualCardsDef(e,a,r,t,s,d){return{cardTypeId:e,pos:a,offerId:r,cardText:t,cardUrl:s,trkId:d||""}}function getCardPos(e){var a=e.data("pos");return a||(a=e.tmplItem().data.pos),a}function showCards(e,a,r,t){if(!showingCards){showingCards=!0,($cardToSlide=getCardById(cardsInfo.cards[e].cardId)).length||($cardToSlide=$(".sbHomeCard").not(".premiumBannerWrap, .toutCard, .sbCustomHomeCard").first());var s=(new Date).getTime(),d=e+1;showingMoreCardsInterval=setInterval((function(){var e=cardsInfo.cards[d];if(e){if(void 0===$cardToSlide.data("loaded")&&($cardToSlide.data("loaded",!0),sbGlbl.isListView||$cardToSlide.addClass("showHomeCard"),$cardToSlide.hasClass("hiddenCard")&&!$cardToSlide.hasClass("disabledCard")&&((new Date).getTime()-s-cardDelay,setTimeout(function(e){return function(){e.hasClass("hiddenCard")&&(addCardToFailedPseudoCardCache(e),disableCard(e))}}($cardToSlide),3e3)),$cardToSlide=getCardById(e.cardId).not(".premiumBannerWrap, .toutCard, .sbCustomHomeCard"),d++,$cardToSlide.length<1)){clearInterval(showingMoreCardsInterval),showingCards=!1;var a=!0;(r&&cardsInfo.cards.length<initialCardLoad.expectedCardCount||!r&&"number"==typeof t&&t<streamManualLoadLength)&&(a=!1),a?$("#sbStreamLoadMoreCtaWrap").fadeIn("fast"):$("#sbStreamLoadMoreCtaWrap").hide()}}else clearInterval(showingMoreCardsInterval),showingCards=!1}),cardDelay)}}function loadMoreCards(auto,callback,count){if(!noMoreCards&&!loadingMoreCards){loadingMoreCards=!0;var cardIndex=cardsInfo.cards.length,lastCard=cardsInfo.cards[cardIndex-1],lastPosNo=lastCard?lastCard.pos:-1,lastCardOffset=0,requestedCardCount;if(cardIndex>0)for(;cardIndex-lastCardOffset>-1&&$.inArray(lastCard.cardTypeId,cardsInfo.templatedVirtual)>-1;)lastCardOffset++,lastCard=cardsInfo.cards[cardIndex-lastCardOffset];requestedCardCount="number"==typeof count?count:auto?streamAutoLoadLength:streamManualLoadLength;var data={h:cardHash,lastPos:lastPosNo,pseudoCards:createPseudoCardStr(!0),sort:cardsInfo.currentSort};void 0===callback&&void 0!==window.loadMoreCardsCallback&&(callback=window.loadMoreCardsCallback);var locationIdParam="undefined"!=typeof streamLocationID?"&loc="+streamLocationID:"",appendToUrl="";"string"==typeof appendToGetCardsUrl?appendToUrl=appendToGetCardsUrl:"function"==typeof appendToGetCardsUrl&&(appendToUrl=appendToGetCardsUrl()),$.post("/?cmd=card-jx-more&streamID="+specificStream+"&count="+requestedCardCount+"&startindex="+nextCardIndex+"&displayedMB="+checkDisplayedMB()+locationIdParam+appendToUrl,data,(function(response){var respInfo=response;if("1"===respInfo.charAt(0)){var respObj=eval("("+respInfo.substring(2)+")"),moreCardsArry=respObj.cards;nextCardIndex=respObj.nextIndex;var moreCardsArrayLength=moreCardsArry.length;return moreCardsArrayLength?(removeXtraCards(),$.merge(cardsInfo.cards,moreCardsArry),updateCardsRealCount(getCardsRealCount()+moreCardsArrayLength),getCards(cardIndex,void 0,moreCardsArrayLength),disableEmptyFilters(),appendExtraCards(),$("#loadMoreDv").fadeIn("fast").children("img:first").hide().end().children("span:first").html("Load More Earning Opportunities"),setTimeout(trackCardsInView,1e3),callNum++):respInfo.length>2&&"1"===respInfo[2]?loadMoreCards(auto):doNoMoreCards(),void(loadingMoreCards=!1)}if("0"===respInfo.charAt(0)&&"LOGIN"==respInfo.substring(2))return noMoreCards=!0,void $("#sbStreamLoadMoreCtaWrap").show().html("You must be logged in to Load More Earning Opportunities. Please refresh your page.");$("#sbStreamLoadMoreCtaWrap").show().html("Sorry, an error occurred. Please refresh your page."),loadingMoreCards=!1})).done((function(){"function"==typeof callback&&callback()}))}}function doNoMoreCards(){noMoreCards=!0,$("#sbStreamLoadMoreCtaWrap").hide()}function undoDoNoMoreCards(){noMoreCards=!1,$("#sbStreamLoadMoreCtaWrap").show().css("cursor","pointer")}function goToVirtualCardActionLnk(e){virtualCardClicked(getCardById(e),!0)}function virtualCardClicked(e,a){virtualClicked(e.data(),a?function(){location.href=e.data("virtualDef").cardUrl}:void 0)}function virtualClicked(e,a){if(e){var r=e.virtualDef;r&&(r.h=cardHash,r.pos=e.accuratePos,$.post("/?cmd=card-pseudo-click",r,(function(e){a&&a(e)})))}}function ntfClicked(e){var a=getCardById(e.cardId),r=a.data("targetBlank"),t=a.data("finalLnk"),s=a.data("ntfData");if(""==s){if(r)(o=window.open(t)).focus();else location.href=t}else{var d=a.data("virtualDef");d.h=cardHash;var o=r?window.open(""):window;$.post("/?cmd=card-pseudo-click"+s,d,(function(e){var a=e.split("|");a.length>1&&"0"==a[1]?(o.location="/?cmd=dr-offer-unavailable",o.focus()):(o.location=decodeURIComponent(t),o.focus())}))}}function showHiddenCard(e){e.data("hdnLoaded",!0).addClass("showHomeCard").removeClass("hiddenCard"),disableEmptyFilters()}function isBLockedOfferProvider(e){return void 0!==pGetCookieValue("h"+e)}function closeCardOnOpenFn(e){var a=e.data("closeCardOnOpen");a&&("function"==typeof a?a(e.tmplItem().data.cardId):"function"==typeof window[a]&&window[a](e))}function soOpenWinDo(e,a){sbHelpers.isNonEmptyString(e)&&sbHelpers.isNonEmptyString(a)&&window.open(e,"_blank",a).focus()}function soOpenWin(e){var a=e.data("offerPop");sbHelpers.isNonEmptyObject(a)&&(soOpenWinDo(a.url,a.params),closeCardOnOpenFn(e))}function masterSoAddCard(e){masterSoCards[e.cardId]=e}function startMasterSo(e,a){masterStarted||(masterStarted=!0,masterSoGetNext(e,a))}function masterSoCardsStartNext(){for(var e in masterSoCards){var a=masterSoCards[e];if(!a.loaded)return void masterSoGetNext(a.cardId,a.cardTypeId)}masterStarted=!1}function masterSoGetNext(e,a){if(soMasterTypes[a].currentIndx>=soMasterTypes[a].types.length)return masterSoCards[e].loaded=!0,void masterSoCardsStartNext();var r=soMasterTypes[a].types[soMasterTypes[a].currentIndx],t=cardsInfo.cardFunctions[r];void 0!==t&&t(e,!0)}function masterSoDoNext(e,a){var r=masterSoCards[e].cardTypeId;if(soMasterTypes[r].currentIndx++,soMasterTypes[r].currentIndx>=soMasterTypes[r].types.length){var t=getCardById(e,a);return t.is(":visible")&&hideCard(t),masterSoCards[e].loaded=!0,void masterSoCardsStartNext()}masterSoGetNext(e,r)}function createTempCardHtml(e,a){var r=a;r.cardTypeId=e,cardsInfo.cardAdditionalData[e]&&$.extend(r,cardsInfo.cardAdditionalData[e]);var t=cardsInfo.templates[e];if(void 0!==t)return $.tmpl(t,r).data("pos",r.pos)}function getCardAndCheckUpdateHtml(e,a,r,t){var s=getCardById(r,t);return virtualTypeId=cardsInfo.typeIds[a],e&&!s.hasClass("cardType"+virtualTypeId)&&(s.replaceWith(createTempCardHtml(virtualTypeId,masterSoCards[r])),s.attr("id",r),s=getCardById(r,t),masterSoCards[r].loaded=!0),s}$("."+cardProps.shopListViewStoreMainCtaClass).live("click",(function(e){generateCardLink($(this).closest("."+cardProps.cardListViewSelector).data(),e.target.classList.contains(cardProps.shopListViewStoreMainCtaClass),!1)})),$(".sbShopCouponsCategoryBodyCta").live("click",(function(e){generateCardLink($(this).closest(".sbShopCouponsCategoryBodyRow").data(),e.target.classList.contains(cardProps.shopListViewStoreMainCtaClass))})),$("#sbStreamLoadMoreCta").live("click",(function(){loadMoreManual()})),function(e){var a=[],r=[];function t(){for(var e=document.getElementById(sbCards.cardProps.cardDeckSelector),a=0,r=sbGlbl.isHome?sbCards.excludedHpTrays:sbCards.excludedDiscoveryTrays,t=0;t<streams.length;t++){var d=streams[t];if(d){var o=d.streamID,i=sbCards.arrHomepageRedesignV12ExcludedStreams,n=sbGlbl.isHome&&Array.isArray(i)&&i.includes(o),l=Boolean(sbHelpers.isTrayMobileViewV2Applicable())&&(sbHelpers.isViewport("tiny")||sbHelpers.isViewport("narrow")),c=sbGlbl.isHome&&Boolean(sbHelpers.isTrayMobileViewV2Applicable())&&(sbHelpers.isViewport("tiny")||sbHelpers.isViewport("narrow"))||l,C=c&&r.includes(o);sbCards.trayMobileViewV2Possible=c,n||C?C&&(sbCards.renderTrayMobileViewV2(e,d,a,sbCards.insertTrayCallout),a++):o!==sbCards.objTrays.bestBuyFeatured?(s(e,d,a),a++,o!==sbCards.objTrays.popularStores&&o!==sbCards.objTrays.coupons||!d.cards.length||(sbCards.renderShopHomepageTray(document.getElementById(cardProps.traySelector+o),d),a++)):(sbCards.renderShopHomepageTray(e,d,a),a++)}}sbCards.insertTrayCallout("sbTrayV3"),sbCards.boolUseQuickLook&&sbCards.initQuickLookMobile()}function s(a,r,t){var s,i=[],n=r.streamID;if(n!==FAVORITES_TRAY||n===FAVORITES_TRAY&&r.cards.length){var l=n!==FAVORITES_TRAY&&n!==NCRAVE_TRAY&&n!==NCRAVE_BET_TRAY&&n!==FEATURED_REWARDS&&n!==sbCards.objTrays.discoverBonusAward;if(n===sbCards.objTrays.answer&&sbCards.addAnswerPromoStarter(r.cards),n===sbCards.objTrays.shopPromotion1&&sbGlbl.isHome&&Object.assign(r,{streamIntro:{title:"Shop",subTitle:"Earn SB when you shop at your favorite stores"},channel:"Shop",rows:2}),s=d(r.cards,n,!0,r.showTooltip,!0===r.isShopPromoTray,r.streamIntro,r.channel,r.allUrl,l,r.rows),o(n)){r.rows=3,i.push("answerDesignV2")}}else n!==FAVORITES_TRAY||r.cards.length||(s=showNullCase(3,!0,void 0,!0));var c=cardProps.traysToLoadAfterPageLoad.indexOf(n)>-1&&0===r.cards.length;c&&e.merge(s,showNullCase(4,!1,void 0,!0)),r.isCouponsTray&&i.push("CouponsTray"),sbGlbl.isHome&&i.push("v1"),sbCards.trayMobileViewV2Possible&&i.push("sbTrayV4"),new Tray({items:s,trayPos:t,id:n,title:r.title,allUrl:r.allUrl,nextIndex:r.nextIndex,rows:r.rows||1,appendToElm:e(a),glueToMaxWidthElm:e(a),allowGetMoreItems:!0,currentSort:r.currentSort,classes:i,isShopPromoTray:!0===r.isShopPromoTray,isTrayMobileViewV2Applicable:sbCards.trayMobileViewV2Possible&&sbHelpers.isTrayMobileViewV2Applicable(),channel:r.channel?r.channel:"",onAfterTrayRendered:function(){var a=this.getId();if(e.each(this.items,(function(){var a=e(this).data();if(e.inArray(a.cardTypeId,cardsInfo.templatedVirtual)>-1){var r=cardsInfo.cardFunctions[a.cardTypeId];void 0!==r&&r(a.cardId,void 0,a)}a.customTmplFn&&"function"==typeof window[a.customTmplFn]&&window[a.customTmplFn](a)})),a==FEATURE_TRAY){var r=e("#sbCompleteProfileCard").detach();r=r.add(e("#sbReferCard").detach()),e((function(){"undefined"!=typeof inviteFriendsCustomCardShow&&inviteFriendsCustomCardShow&&(hasStaticCardsTray||specificStream)||e("#sbReferCard").addClass("inactive")})),this.addItems(r)}else if(c){var t=this;t.reloadTray((function(){t.removeTrayIfEmpty(!1,!0)}))}},onGoToNext:function(e){this.loadCards(!0,void 0,void 0,void 0,e,!1)},onAfterGoToNext:function(){trackCardsInView()},onSeeAll:function(){urlParam("viewAll")?urlParam("viewAll",trayId):location.href.indexOf("?")>-1?location.href=location.href+"&viewAll="+trayId:location.href=location.href+"?viewAll="+trayId}}),sbGlbl.streamsMetadata.push(r.streamID+","+r.showViewMore+","+r.currentSort+","+r.allUrl),sbCards.insertTrayCallout("sbTrayV3"),sbCards.boolUseQuickLook&&sbCards.initQuickLookMobile()}function d(a,r,t,s,d,o,i,c,C,p){var u,f=e(),b=[],m=[],h=cardProps.starterCardSelector+r,g=h===cardProps.starterCardSelector+sbCards.objTrays.shopAndEarn&&sbGlbl.objCards.hadCardBeenClosed(h)&&!sbCards.trayMobileViewV2Possible;if(r===FAVORITES_TRAY&&"boolean"==typeof s&&s&&a.length)f=createAndAddCard(e.extend({},cardProps.favoritesTrayNullCaseCardProps,cardProps.favoritesTrayPrefilledCaseCardProps),!1,r,f);else if(r!==sbCards.objTrays.answer||sbCards.initialProfilerCompleted){if("object"==typeof o&&(!sbGlbl.objCards.hadCardBeenClosed(h)&&!sbCards.trayMobileViewV2Possible||g)){var I=sbCards.swagUpShopPromo;r===sbCards.objTrays.shopAndEarn&&sbHelpers.isNonEmptyObject(I)&&I.active&&(o=sbCards.generateShopPromoStreamIntro(I.bonusFormatted)),r===sbCards.objTrays.continuePlayingOffers&&(c="/discover/mobile-games"),f=createAndAddCard(e.extend({trayId:r,strChannel:i||"",strAllUrl:c||""},o,cardProps.starterCardProps),!1,r,f)}}else{var y=a.find((function(e){return!0===e.isProfiler}));if(sbHelpers.isObject(y)){var v=cardProps.answerNoInitialProfilerCaseProps;v.earn=y.earn,v.timeComplete=y.timeComplete}f=createAndAddCard(e.extend({},v),!1,r,f)}for(var S=a.length,T=cardProps.firstPageOfCardsCount*p,P=S<=T?S:T,w=!1,A=null,k=0;k<S;k++){if(A=a[k],C&&r!=cardProps.highestPriorityStreamId&&(l(A)&&k<P?(P++,w=!0):k<P&&n(A)),16!=(u=e.extend(a[k],{trayId:r,strChannel:i||""})).cardTypeID||w)if(15!=u.cardTypeID||w){if(void 0===d){var D=sbCards.getTrayProperties(r);"object"==typeof D&&(d=D.isShopPromoTray)}d&&(u=e.extend(a[k],{isShopPromoTray:!0})),(u=createCard(u,e.inArray(u.cardTypeID,cardsInfo.templatedVirtual)>-1,r))&&!w?f=f.add(u):u||P++}else u.isTrackable=void 0!==u.trkId,m.push(u);else b.push(u);w=!1}(r==FEATURE_TRAY||r==DISCOVER_FEATURED_TRAY||r==OFFER_UNAVAILABLE)&&sbGlbl.premiumAndFeaturedCards.featured.length&&t&&(f=sbGlbl.sbHomeAd.createFeaturedCards(sbGlbl.premiumAndFeaturedCards.featured,!0,i).add(f)),m.length&&(f=sbGlbl.sbHomeAd.createFeaturedCards(m,!1,i).add(f)),(r==FEATURE_TRAY||r==DISCOVER_FEATURED_TRAY||r==OFFER_UNAVAILABLE)&&sbGlbl.premiumAndFeaturedCards.premium.length&&t&&(f=sbGlbl.sbHomePremiumBanner.createPremiumBanners(sbGlbl.premiumAndFeaturedCards.premium,r,!0,i).add(f)),b.length&&(f=sbGlbl.sbHomePremiumBanner.createPremiumBanners(b,r,!1,i).add(f));var L=sbGlbl.objNCravePlacements;return-1!=[NCRAVE_TRAY,NCRAVE_BET_TRAY].indexOf(r)&&void 0!==L&&void 0!==L.nCraveCards&&(L[r==NCRAVE_BET_TRAY?"nCraveBetCards":"nCraveCards"]=f.clone(!0,!0)),f}function o(e){return e===sbCards.objTrays.answer&&sbCards.answerCardV2Applicable&&!sbHelpers.isViewport("tiny")}function i(e){if(sbCards.answerPromoApplicable){var a=document.getElementById("sbCardsJson"),r=sbHelpers.getJsonScriptContent(a);if(sbHelpers.isObject(r)){var t=r.answer;sbHelpers.isObject(t)&&t.emailOrPinVerified&&e.unshift({cardTypeId:window.cardProps.answerPromoStarterCardTypeId,cardId:32768})}}}function n(e,t){var s=sbHelpers.isNumeric(t)?t:e.cardId,d=e.offer;a.push(s),sbHelpers.isNumeric(d)&&r.push(d)}function l(e){return a.includes(e.cardId)||r.includes(e.offer)}function c(a){var r=a.trayId,t=sbCards.getTrayProperties(r);if("object"==typeof t){var s=sbCards.getTrayCards(t);if("object"==typeof s){for(var d,o,i,l=t.rows,c=cardProps.firstPageOfCardsCount*l,C=s.length,p=C<=c?C:c,u=a.cardId,f=[],b=0;b<p;b++)(i=(o=(d=e(s[b])).tmplItem().data).realCardId)&&(d.hasClass("hiddenCard disabledCard")?p++:(n(o,i),f.push(i)));var m=Trays.getAll();for(var h in m)if(h!=cardProps.highestPriorityStreamId){var g=m[h].items;for(b=0;b<g.length;b++){var I=e(g[b]);(u=I.tmplItem().data.realCardId)&&(f.indexOf(u)>-1&&disableCard(I))}}}}}function C(e){var a=document.getElementById("sbCardsJson"),r=sbHelpers.getJsonScriptContent(a),t=r&&r.discover&&r.discover.isDiscoverPage;return!sbHelpers.isMember()&&t?sbHelpers.formatCurrencyNumber(sbCards.calculateCashValue(e),{},sbGlbl.getCardsLocation()):e+" SB"}function p(){var e=document.getElementById("rclonFlowBehavior");if(e){var a=sbHelpers.getJsonScriptContent(e);if(sbHelpers.isObject(a))return a.rclonFlowBehavior}}function u(e){isShopCardType(e.cardTypeId)&&sbCards.objTrays.shopAndEarn===e.trayId&&(e.targetBlank=!0,e.detailsLink=sbHelpers.updateQueryString({merchant:e.merchantId},"/g/shopredir"))}function f(){var e=Boolean(sbHelpers.isTrayMobileViewV2Applicable())&&(sbHelpers.isViewport("tiny")||sbHelpers.isViewport("narrow"));return!(sbPage.boolIsShopAllStoresListView||e)}window.getTrays=t,window.createCards=d,sbCards.isAnswerCardV2Applicable=o,sbCards.addAnswerPromoStarter=i,sbCards.refreshDuplicateCheck=c,sbCards.getEarnValue=C,sbCards.shouldUseRclonFlowBehavior=p,sbCards.updateToRclonFlowBehavior=u,sbCards.loadMoreOnScrollApplicable=f,function(){if("undefined"!=typeof streams){for(var e,a,r,t,s=0;null===(t=streams[s])||(a=t.cards)&&(!a||!a.length);)s++;if(r=t,cardProps.highestPriorityStreamId=r.streamID,e=a)for(var d,o,i,l=e.length,c=cardProps.firstPageOfCardsCount*r.rows,C=l<=c?l:c,p=null,u=0;u<C&&(d=(p=e[u]).cardTypeId,o=void 0===sbGlbl.cardTmplOverride?d:sbGlbl.cardTmplOverride,i=cardsInfo.templates[o],l>=C+1);u++)void 0===i&&o!==cardProps.intOfferServerFeaturedCardTypeId?C++:n(p)}}()}(jQuery),sbCards.shouldUseOfferModalInsteadOfFlyout=function(e,a,r,t,s){if(!e||!a||!sbCards.objTrays||!window.cardProps||t)return!1;if(6===r)return!1;var d=document.getElementById("discoverOfferFeatures");if(d){var o=sbHelpers.getJsonScriptContent(d);if(sbHelpers.isObject(o)&&s<=o.maxSbToDisplayOfferModal)return!1}return![sbCards.objTrays.inStoreDeals,sbCards.objTrays.continuePlayingOffers].includes(a)&&[window.cardProps.intOfferServerPremiumCardTypeId,window.cardProps.intOfferServerFeaturedCardTypeId,window.cardProps.intOfferServerStandardCardTypeId].includes(e)},sbCards.handleTabsOnCardClick=function(e){var a=e.tmplItem,r=e.strTab1CardClickURL,t=e.tab1,s=e.tab2,d=e.boolUseTab2,o=e.strTab2FinalUrl;if(d&&sbHelpers.isNonEmptyString(o)&&s.location.assign(sbCards.generateCardClickUrl(a,o)),a.buttonSdkToBeUtilized)window.location.href=r;else{if(sbHelpers.isNull(t))return;t.location.assign(r),t.focus()}},sbCards.getWebSearchCardOrFlyoutClickUrl=function(e){var a=e.tmplItem,r=e.strTab1FinalUrl,t=e.boolIsFlyoutClick,s=sbCards.generateCardClickUrl(a,r);if(t){var d=e.event.target,o=d.classList,i=a.detailsLink;if(o.contains("hoverDetailsHeaderMainCta"))return i;var n="hoverDetailsHeader";if(d.parentNode.classList.contains(n)||sbHelpers.isElementDescendantOfParent(d.closest(".hoverDetailsHeader"),d)||o.contains("hoverDetailsSecondaryCta")){var l=sbHelpers.updateQueryString({bb:sbHelpers.backButton.urlParamValue,page:3},i);return window.open(l).focus(),a.link}}return s},sbCards.shouldUseQuickLookModal=function(e){if(!e||!sbCards.objTrays)return!1;return"Discover"===e.strChannel&&!(e.trayId===sbCards.objTrays.partners||49===e.cardTypeId)},function(){"use strict";function e(e,a){a.preventDefault(),a.stopPropagation(),function(e,a){var r=document.createElement("DIV");r.insertAdjacentHTML("beforeend",'<form hidden action="'+window.location.origin+e+'" method="post"><input type="hidden" name="redirectUrl" value="'+a+'"></form>'),sbPage.$$body.append(r),r.querySelector("form").submit()}("/?cmd=ac-login",e)}sbCards.redirectOnCardClick=function(a,r){if(sbCards.cardtypesForLoggedOutRedirect.includes(a)){var t=document.getElementById("sbLogInCta");if(t&&t.addEventListener("click",e.bind(null,r)),window.customRedirectUrl=r,sbGlbl.intPageId===cardProps.TOP_OFFERS_PAGE_ID)return void sbCards.showCustomSignupModal(r)}"discover"===sbPage.strChannelName?sbGlbl.sbTb.redirectToCheckinPage("Reg"):window.location.href=r}}();var ntfCardTypes={0:{text:"Discover",className:"isSpecialOffersCard",cardIcon:"specialOffersCard"},1:{text:"Answer",className:"isSurveyCards",cardIcon:"answerCard",cta:"Answer"},2:{text:"Discover: Coupons",className:"isCouponsCard",cardIcon:"couponsCard"},3:{text:"Watch",className:"isSBTVCard",cardIcon:"watchCard",cta:"Watch"},4:{text:"Answer",className:"isPollsCard",cta:"Answer"},5:{text:"Play",className:"isGamesCard",cardIcon:"playCard",cta:"Play"},6:{text:"Tasks",className:"isTasksCard"},7:{text:"SwagButton",className:"isToolbarCard"},9:{text:"Swagstakes",className:"isSwagstakesCard"},10:{text:"Swag Store",className:"isStoreCard"},11:{text:"Youtube",className:"isYoutubeCard"},12:{text:"Blog",className:"isBlogCard"},13:{text:"Swagstakes",className:"isDessSwagstakesCard"},14:{text:"Shop",className:"isShopEarnCard",cardIcon:"shopCard",cta:"Shop",perDollar:!0},17:{text:"Explore",className:"isSpecialOffersCard",cardIcon:"specialOffersCard"},18:{text:"Sign Up",className:"isSpecialOffersCard",cardIcon:"specialOffersCard"},19:{text:"Donate",className:"isSpecialOffersCard",cardIcon:"specialOffersCard"},20:{text:"Try",className:"isSpecialOffersCard",cardIcon:"specialOffersCard"},21:{text:"Install",className:"isSpecialOffersCard",cardIcon:"specialOffersCard"},22:{text:"Enter",className:"isSpecialOffersCard",cardIcon:"specialOffersCard"},23:{text:"Call",className:"isSpecialOffersCard",cardIcon:"specialOffersCard"},24:{text:"Shop",className:"isShopEarnCard",cardIcon:"shopCard",cta:"Shop"},25:{text:"Sponsored",className:"isSponsoredCard",cardIcon:"sponsoredCard",cta:"Check Offers",aboutHeading:"About"}};function videosAvailable(e){sbCards.junCardRenderer.onJson(e)}function goToJun(){sbCards.junCardRenderer.click()}sbCards.junCardRenderer=function(){var e=!1,a=!1,r=!1,t=$();function s(e,a,s,d){r?(disableCard(d,!0,!0),function(e,a,r){var s=getCardById(e,r).tmplItem().data.trkId,d="/?cmd=gn-jun-frame&home=1&cardid="+e,o=getCardAndCheckUpdateHtml(a,"jun",e,r),i=addToVirtualCardsDef(cardsInfo.typeIds.jun,getRealCardPos(o),"","Take A Discovery Break JunGroup has some content it would like you to explore. Take a look. You might just like it.",d,s);d+="&trkid="+s;var n="Take A Discovery Break",l="JunGroup has some content it would like you to explore. Take a look. You might just like it.";$("#"+cardProps.cardHeaderId+e).html(n),o.data({master:a,virtualDef:i,offerPop:{url:d,params:"status=0,toolbar=0,scrollbars=0,width=800,height=585,resizable=disallow"},clickFnCustom:"goToJun",header:n,subHeader:l}),$.extend(o.tmplItem().data,o.data()),a&&masterSoCardsStartNext();showHiddenCard(o),t=o}(e,a,s)):a?masterSoDoNext(e,s):(addCardToFailedPseudoCardCache(d),disableCard(d))}function d(){banner.showWarning("Sorry, this offer is no longer available. Please check back at a later time.")}function o(){soOpenWin(t)}return{start:function(r,t,d){if(isBLockedOfferProvider("jun")){t?masterSoDoNext(r,d):(addCardToFailedPseudoCardCache(o=getCardById(r,d)),disableCard(o))}else{e||(e=!0,pLoadScript(junCall));var o=getCardById(r,d);if(a)s(r,t,d,o);else{disableCard(o,!0);var i=setInterval((function(){a&&(clearInterval(i),s(r,t,d,o))}),100)}}},onJson:function(e){e>0&&(r=!0),a=!0},click:function(){$.ajax({type:"GET",url:window.location.origin+"/?cmd=wa-score-check&typeKey=jungroup",success:function(e){if(e.block)d();else if(e.partnersToScore&&e.partnersToScore instanceof Array)if(e.partnersToScore.length){var a=sbGlbl.objWatchPlaylists,r="object"==typeof a?a.score:void 0;"function"==typeof r?r(e).done((function(){o()})).fail((function(){d()})):d()}else o();else d()}})}}}();var mbCalled=!1,mbLoaded=!1,mbJson=void 0;function mbInit(e){if(!mbCalled||null!=e){mbCalled=!0;var a=mbDwids.dwids[0];a&&pLoadScript(mbCall.replace("@@DWID@@",a))}}function onMbJson(e){e.wanted?(e.link=mbDwids[e.campaignId],mbJson=e,mbLoaded=!0):(mbDwids.dwids.splice(0,1),mbDwids.dwids.length>0&&mbInit(!0)),mbLoaded=!0}function checkMB(e,a,r){if(0!=mbDwids.dwids.length){mbInit();s=getCardById(e,r);if(mbLoaded)mbGo(e,a,r,s);else{disableCard(s,!0);var t=setInterval((function(){mbLoaded&&(clearInterval(t),mbGo(e,a,r,s))}),500)}}else{var s;disableCard(s=getCardById(e,r))}}function mbGo(e,a,r,t){mbJson&&mbJson.wanted&&null!==mbJson.link&&void 0!==mbJson.link?(disableCard(t,!0,!0),(t=getCardAndCheckUpdateHtml(a,"mb",e,r)).data({specialTerms:"* For help, please contact Swagbucks Support and reference Survey # "+mbJson.campaignId}),mbJson.link+="&trkid="+t.tmplItem().data.trkId,$.extend(t.tmplItem().data,mbJson),showHiddenCard(t)):a?masterSoDoNext(e,r):(addCardToFailedPseudoCardCache(t=getCardById(e,r)),disableCard(t))}var gambitCalled=!1,gambitLoaded=!1,gambitAvai=!1,gambitJson=new Array,gambitCurrent=0;function gambitInit(){gambitCalled||(gambitCalled=!0,pLoadScript(gambitCall))}function onGambitJson(e){(gambitJson=e).length>0&&(gambitAvai=!0),gambitLoaded=!0}function gambitDo(e,a,r){if(isBLockedOfferProvider("Gambit")){a?masterSoDoNext(e,r):(addCardToFailedPseudoCardCache(t=getCardById(e,r)),disableCard(t))}else{gambitInit();var t=getCardById(e,r);if(gambitLoaded)gambitGo(e,a,r,t);else{disableCard(t=getCardById(e,r),!0);var s=setInterval((function(){gambitLoaded&&(clearInterval(s),gambitGo(e,a,r,t))}),100)}}}function gambitGo(e,a,r,t){gambitAvai&&gambitJson.length>0?(gambitCurrent=Math.floor(Math.random()*gambitJson.length),disableCard(t,!0,!0),gambitShow(e,a,r)):a?masterSoDoNext(e,r):(addCardToFailedPseudoCardCache(t),disableCard(t))}function gambitShow(e,a,r){var t=getCardById(e,r).tmplItem().data.trkId,s=gambitJson[gambitCurrent],d=getCardAndCheckUpdateHtml(a,"gambit",e,r),o=s.title.replace("{amount}",s.cpa),i=addToVirtualCardsDef(cardsInfo.typeIds.gambit,getRealCardPos(d),s.offer_id,o,s.callback_url,t);gambitJson.splice(gambitCurrent,1),s.callback_url+="&subid1="+t,setPseudoCardImg(e,cardsInfo.typeIds.gambit),sbCards.asyncUpdatePayout(e,s.cpa),$("#"+cardProps.cardHeaderId+e).html(o),d.data({header:o,subHeader:s.body.replace("{amount}",s.cpa),earn:s.cpa,master:a,virtualDef:i,offerPop:{url:"/?cmd=gn-so-gen-frame&url="+encodeURIComponent(s.callback_url.replace(/&amp;/g,"&"))+"&w="+s.offer_width+"&h="+s.offer_height+"&p=gambit&cardid="+e,params:"status=0,toolbar=0,scrollbars=0,width="+s.offer_width+",height="+s.offer_height+",resizable=disallow"}}),a&&masterSoCardsStartNext(),showHiddenCard(d)}function gambitClosed(e){var a=getCardById(e),r=a.data("master");gambitJson.length>0?(gambitCurrent=Math.floor(Math.random()*gambitJson.length),gambitShow(e,r)):(gambitAvai=!1,r?masterSoDoNext(e):(addCardToFailedPseudoCardCache(a),disableCard(a)))}var _spCalled=!1,_spLoaded=!1,_sp_video="",_spFullyLoaded=!1,_spNoOffers=!1,_spCurrent=0;function _spInit(){_spCalled||(_spCalled=!0,pLoadScript("https://iframe.sponsorpay.com/javascripts/widget/v2/widgets.js"))}function _spDo(e,a,r){if(isBLockedOfferProvider("Sp"))a?masterSoDoNext(e,r):(addCardToFailedPseudoCardCache(t=getCardById(e,r)),disableCard(t));else if(_spInit(),_spLoaded)trySponsorpay(e,a,r);else{var t;disableCard(t=getCardById(e,r),!0);var s=setInterval((function(){"undefined"!=typeof SPONSORPAY&&void 0!==SPONSORPAY.Video&&void 0!==SPONSORPAY.Video.Iframe&&(clearInterval(s),_spLoaded=!0,trySponsorpay(e,a,r))}),100)}}function trySponsorpay(e,a,r){var t=getCardById(e,r);if(""==_sp_video)(_sp_video=new SPONSORPAY.Video.Iframe({appid:"2076",uid:soSbMemId,display_format:"bare_player",width:"750",height:"750",callback_on_start:function(){sponsorpayGo(e,a,r,t),_spFullyLoaded=!0},callback_on_conversion:function(){},callback_no_offers:function(){_spFullyLoaded=!0,_spNoOffers=!0,a?masterSoDoNext(e):(addCardToFailedPseudoCardCache(t),disableCard(t))}})).backgroundLoad();else var s=setInterval((function(){if(_spFullyLoaded){if(clearInterval(s),_spNoOffers)return void(a?masterSoDoNext(e,r):(addCardToFailedPseudoCardCache(t),disableCard(t)));sponsorpayGo(e,a,r,t)}}),1e3)}function sponsorpayGo(e,a,r,t){if(_sp_video._offers&&_sp_video._offers.length>0){if(_spCurrent=Math.floor(Math.random()*_sp_video._offers.length),!_sp_video._offers[_spCurrent].video)return _sp_video._offers.splice(_spCurrent,1),void sponsorpayGo(e,a,r,t);disableCard(t,!0,!0),doSponsorpay(e,a,r)}else a?masterSoDoNext(e,r):(addCardToFailedPseudoCardCache(t),disableCard(t))}function doSponsorpay(e,a,r){var t=getCardById(e,r).tmplItem().data.trkId,s=_sp_video._offers[_spCurrent];_sp_video._offers.splice(_spCurrent,1);var d=getCardAndCheckUpdateHtml(a,"_sp",e,r),o=addToVirtualCardsDef(cardsInfo.typeIds._sp,getRealCardPos(d),"",s.title,s.url,t),i=parseInt($.trim(s.reward.substring(s.reward.indexOf(">")+1,s.reward.indexOf("</"))));sbCards.asyncUpdatePayout(e,i),$("#"+cardProps.cardHeaderId+e).html(s.title),d.data({header:s.title,subHeader:s.teaser,earn:i,master:a,virtualDef:o,offerPop:{url:"/?cmd=gn-so-gen-frame&url="+encodeURIComponent(s.url+"?integration=video_iframe&width="+s.width+"&height="+s.height+"&show=SP%3AF%3BDI%3AF%3BDR%3AF&display_format=bare_player&pub0="+t)+"&w="+s.width+"&h="+s.height+"&p=sponsorpay&cardid="+e,params:"status=0,toolbar=0,scrollbars=0,width="+s.width+",height="+s.height+",resizable=disallow"}}),a&&masterSoCardsStartNext(),showHiddenCard(d)}function sponsorpayClosed(e){var a=getCardById(e),r=a.data("master");if(_sp_video._offers.length>0){if(_spCurrent=Math.floor(Math.random()*_sp_video._offers.length),!_sp_video._offers[_spCurrent].video)return _sp_video._offers.splice(_spCurrent,1),void sponsorpayClosed(e);doSponsorpay(e,r)}else r?masterSoDoNext(e):(addCardToFailedPseudoCardCache(a),disableCard(a))}var _ssaCalled=!1,_ssaLoaded=!1,_ssaAvai=!1,_ssaJson=new Array,_ssaCurrent=0;function _ssaInit(){_ssaCalled||(_ssaCalled=!0,pLoadScript("http://jsd.supersonicads.com/inlineDelivery/delivery.min.gz.js"))}function onSsa(e){(_ssaJson=e).length>0&&(_ssaAvai=!0),_ssaLoaded=!0}function onSsaDone(){}function _ssaDo(e,a,r){if(isBLockedOfferProvider("Ssa")){a?masterSoDoNext(e,r):(addCardToFailedPseudoCardCache(t=getCardById(e,r)),disableCard(t))}else{_ssaInit();var t=getCardById(e,r);if(_ssaLoaded)_ssaGo(e,a,r,t);else{disableCard(t,!0);var s=setInterval((function(){_ssaLoaded&&(clearInterval(s),_ssaGo(e,a,r,t))}),100)}}}function _ssaGo(e,a,r,t){_ssaAvai&&_ssaJson.length>0?(_ssaCurrent=Math.floor(Math.random()*_ssaJson.length),disableCard(t,!0,!0),_ssaShow(e,a,r)):a?masterSoDoNext(e,r):(addCardToFailedPseudoCardCache(t),disableCard(t))}function _ssaShow(e,a,r){var t=getCardById(e,r).tmplItem().data.trkId,s=_ssaJson[_ssaCurrent],d=getCardAndCheckUpdateHtml(a,"_ssa",e,r),o=addToVirtualCardsDef(cardsInfo.typeIds._ssa,getRealCardPos(d),s.offerId,s.callToAction,s.url,t);_ssaJson.splice(_ssaCurrent,1),s.url=s.url.replace("uniquecstmtrkid",t),setPseudoCardImg(e,cardsInfo.typeIds._ssa),$("#"+cardProps.cardHeaderId+e).html(s.callToAction),sbCards.asyncUpdatePayout(e,s.rewards),d.data({header:s.callToAction,earn:s.rewards,master:a,virtualDef:o,offerPop:{url:"/?cmd=gn-so-gen-frame&url="+encodeURIComponent(s.url)+"&w="+s.width+"&h="+s.height+"&p=ssa&cardid="+e,params:"status=0,toolbar=0,scrollbars=0,width="+s.width+",height="+s.height+",resizable=disallow"}}),a&&masterSoCardsStartNext(),showHiddenCard(d)}function ssaClosed(e){var a=getCardById(e),r=a.data("master");_ssaJson.length>0?(_ssaCurrent=Math.floor(Math.random()*_ssaJson.length),_ssaShow(e,r)):(_ssaAvai=!1,r?masterSoDoNext(e):(addCardToFailedPseudoCardCache(a),disableCard(a)))}var peanutCalled=!1,peanutLoaded=!1,peanutAvai=!1,peanutJson={};function peanutInit(){peanutCalled||(peanutCalled=!0,pLoadScript(peanutCall))}function onPeanutJson(peanutInfo){peanutJson=eval("("+peanutInfo+")"),peanutJson.response>0&&(peanutAvai=!0),peanutLoaded=!0}function peanutDo(e,a,r){if(isBLockedOfferProvider("Peanut")){a?masterSoDoNext(e,r):(addCardToFailedPseudoCardCache(t=getCardById(e,r)),disableCard(t))}else{peanutInit();var t=getCardById(e,r);if(peanutLoaded)peanutGo(e,a,r,t);else{disableCard(t,!0);var s=setInterval((function(){peanutLoaded&&(clearInterval(s),peanutGo(e,a,r,t))}),100)}}}function peanutGo(e,a,r,t){peanutAvai?(disableCard(t,!0,!0),peanutShow(e,a,r)):a?masterSoDoNext(e,r):(addCardToFailedPseudoCardCache(t),disableCard(t))}function peanutShow(e,a,r){var t,s,d,o=getCardAndCheckUpdateHtml(a,"peanut",e,r);2==peanutJson.response?(t="Unlock New Survey Opportunities!",s="You may qualify for free surveys that let you earn hundreds of SB. Unlock surveys now by filling out your profile!",d="Unlock"):(t="New Surveys Available",s="Surveys are one of the quickest ways to earn <em>big</em> SB, fast! Give your opinion on these new surveys and earn.",d="Go",$("#numberSurveys"+e).html(peanutJson.numberSurveys));var i=o.tmplItem().data.trkId,n=o.tmplItem().data.link;"/"==n&&(n="/surveys/peanutlabs"),o.data().cardTypeId==cardsInfo.typeIds.peanut&&(n="/discover/offer-walls/35/peanut-labs"),i&&(n+="?trkid="+i);var l=addToVirtualCardsDef(cardsInfo.typeIds.peanut,getRealCardPos(o),"",t,n,i);setPseudoCardImg(e,cardsInfo.typeIds.peanut),$("#"+cardProps.cardHeaderId+e).html(t),o.data({header:t,subHeader:s,aboutHeading:"Details",numberSurveys:peanutJson.numberSurveys,upTo:!0,master:a,cta:d,moreInfo:"powered by Peanut Labs",link:n,clickFnCustom:"goToPeanut",virtualDef:l}),a&&masterSoCardsStartNext(),hidePeanutLabsCard||showHiddenCard(o)}function goToPeanut(e){return goToVirtualCardActionLnk(e.cardId),!0}var tpCalled=!1,tpDone=!1,tpArry=[],tpCurrent=0,tpObject,tpCardLoaded=!1;function tpInit(){tpCalled||(tpCalled=!0,pLoadScript("https://s-assets.tp-cdn.com/static3/js/api/payment_overlay.js"))}function tpDo(e,a,r){var t;isBLockedOfferProvider("tp")?a?masterSoDoNext(e,r):(addCardToFailedPseudoCardCache(t=getCardById(e,r)),disableCard(t)):tpDone?a?masterSoDoNext(e,r):(addCardToFailedPseudoCardCache(t=getCardById(e,r)),disableCard(t)):(window.trialpayAsync=function(e,a,r){return function(){tpGo(e,a,r)}}(e,a,r),tpInit())}function tpGo(e,a,r){if(tpDone)if(a)masterSoDoNext(e,r);else{var t=getCardById(e,r);addCardToFailedPseudoCardCache(t),disableCard(t)}else{tpDone=!0;var s={mode:"tpdirect",vic:"b99b0d77290d58f663e1bdc6a74620e8",onOfferAvailable:function(e,a,r){return function(t){tpHasOffers(e,a,t,r)}}(e,a,r),onOfferUnavailable:function(e,a,r){return function(t){tpUnavailable(e,a,t,r)}}(e,a,r),zIndex:9999,trkid:getCardById(e,r).tmplItem().data.trkId};$.extend(tp_params_all,s),tpObject=new TRIALPAY.api(tp_params_all)}}function tpUnavailable(e,a,r,t){if(a)masterSoDoNext(e,t);else{var s=getCardById(e,t);addCardToFailedPseudoCardCache(s),disableCard(s)}}function tpHasOffers(e,a,r,t){r.length?(tpArry=r,tpShow(e,a,t),tpObject.recordImpression()):tpUnavailable(e,a,r,t)}function tpShow(e,a,r){var t,s=getCardAndCheckUpdateHtml(a,"tp",e,r),d=addToVirtualCardsDef(cardsInfo.typeIds.tp,getRealCardPos(s),tpArry[tpCurrent].id,s.find(".cardContentHeader").html(),"",getCardById(e,r).tmplItem().data.trkId),o="Earn Easy SB!";setPseudoCardImg(e,cardsInfo.typeIds.tp),$("#"+cardProps.cardHeaderId+e).html(o),t="video"==tpArry[tpCurrent].type?"Watch this video in its entirety to earn SB":"category"==tpArry[tpCurrent].type?"Check out today's offers":"Check out today's offer",tpCardLoaded||(s.data({header:o,subHeader:t,master:a,virtualDef:d}),a&&masterSoCardsStartNext(),showHiddenCard(s),tpCardLoaded=!0)}function tpClicked(){tpObject.triggerClick()}var buzzCalled=!1,buzzArray=[],buzzAvai=!1,buzzLoaded=!1,buzzCurrent=0;function buzzInit(){buzzCalled||(buzzCalled=!0,pLoadScript(buzzCall))}function onBuzzJson(e){e.length>0&&(buzzAvai=!0,buzzArray=e),buzzLoaded=!0}function buzzDo(e,a,r){if(!isBLockedOfferProvider("buzz")&&buzzAgeOk){buzzInit();s=getCardById(e,r);if(buzzLoaded)buzzGo(e,a,r,s);else{disableCard(s,!0);var t=setInterval((function(){buzzLoaded&&(clearInterval(t),buzzGo(e,a,r,s))}),100)}}else{var s;a?masterSoDoNext(e):(addCardToFailedPseudoCardCache(s=getCardById(e,r)),disableCard(s))}}function buzzGo(e,a,r,t){buzzAvai&&buzzArray.length>0?(buzzCurrent=Math.floor(Math.random()*buzzArray.length),disableCard(t,!0,!0),buzzShow(e,a,r)):a?masterSoDoNext(e):(addCardToFailedPseudoCardCache(t),disableCard(t))}function buzzShow(e,a,r){var t=buzzArray[buzzCurrent],s=getCardAndCheckUpdateHtml(a,"buzz",e,r),d=addToVirtualCardsDef(cardsInfo.typeIds.buzz,getRealCardPos(s),"",t.title,t.url,getCardById(e,r).tmplItem().data.trkId);buzzArray.splice(buzzCurrent,1),setPseudoCardImg(e,cardsInfo.typeIds.buzz),sbCards.asyncUpdatePayout(e,t.sb_amount),$("#"+cardProps.cardHeaderId+e).html(t.title),s.data({header:t.title,earn:t.sb_amount,master:a,virtualDef:d,offerPop:{url:"/?cmd=gn-so-gen-frame&url="+encodeURIComponent(t.url)+"&type="+t.url_type+"&w="+t.width+"&h="+t.height+"&p=buzz&cardid="+e,params:"status=0,toolbar=0,scrollbars=0,width="+t.width+",height="+t.height+",resizable=disallow"}}),a&&masterSoCardsStartNext(),showHiddenCard(s)}function buzzClosed(e){var a=getCardById(e),r=a.data("master");buzzArray.length>0?(buzzCurrent=Math.floor(Math.random()*buzzArray.length),buzzShow(e,r)):(buzzAvai=!1,r?masterSoDoNext(e):(addCardToFailedPseudoCardCache(a),disableCard(a)))}var srCalled=!1,srArray=[],srAvai=!1,srLoaded=!1,srCurrent=0;function srInit(){srCalled||(srCalled=!0,pLoadScript(srCall))}function onSrJson(e){e.offers&&e.offers.length>0&&(srAvai=!0,srArray=e.offers),srLoaded=!0}function srDo(e,a,r){if(isBLockedOfferProvider("sr")){a?masterSoDoNext(e,r):(addCardToFailedPseudoCardCache(t=getCardById(e,r)),disableCard(t))}else{srInit();var t=getCardById(e,r);if(srLoaded)srGo(e,a,r,t);else{disableCard(t,!0);var s=setInterval((function(){srLoaded&&(clearInterval(s),srGo(e,a,r,t))}),100)}}}function srGo(e,a,r,t){srAvai&&srArray.length>0?(srCurrent=Math.floor(Math.random()*srArray.length),disableCard(t,!0,!0),srShow(e,a,r)):a?masterSoDoNext(e,r):(addCardToFailedPseudoCardCache(t),disableCard(t))}function srShow(e,a,r){var t=srArray[srCurrent];srArray.splice(srCurrent,1);var s=getCardAndCheckUpdateHtml(a,"sr",e,r),d=addToVirtualCardsDef(cardsInfo.typeIds.sr,getRealCardPos(s),t.id,t.video_name,t.embed_code,getCardById(e,r).tmplItem().data.trkId);$("#"+cardProps.cardHeaderId+e).html(t.video_name),s.data({header:t.video_name,subHeader:t.description,master:a,virtualDef:d,offerPop:{url:"/?cmd=gn-so-gen-frame&url="+encodeURIComponent(t.embed_code.substring(t.embed_code.indexOf("http://"),t.embed_code.indexOf('.js"><\/script>')))+"&w=425&h=375&p=sr&type=script&cardid="+e,params:"status=0,toolbar=0,scrollbars=,scrollbars=0,width=425,height=375,resizable=disallow"}}),a&&masterSoCardsStartNext(),showHiddenCard(s)}function srClosed(e){var a=getCardById(e),r=a.data("master");srArray.length>0?(srCurrent=Math.floor(Math.random()*srArray.length),srShow(e,r)):(srAvai=!1,r?masterSoDoNext(e):(addCardToFailedPseudoCardCache(a),disableCard(a)))}var roCalled=!1,roLoaded=!1,roAvai=!1,roJson=new Array,roCurrent=0,roArray=[];function roInit(){roCalled||(roCalled=!0,pLoadScript(roCall))}function onRoJson(e){(roJson=e).offers&&roJson.offers.length>0&&(roAvai=!0,roArray=roJson.offers),roLoaded=!0}function roDo(e,a,r){if(isBLockedOfferProvider("ro")){a?masterSoDoNext(e,r):(addCardToFailedPseudoCardCache(t=getCardById(e,r)),disableCard(t))}else{roInit();var t=getCardById(e,r);if(roLoaded)roGo(e,a,r,t);else{disableCard(t,!0);var s=setInterval((function(){roLoaded&&(clearInterval(s),roGo(e,a,r,t))}),100)}}}function roGo(e,a,r,t){roAvai&&roJson.offers.length>0?(roCurrent=Math.floor(Math.random()*roJson.offers.length),disableCard(t,!0,!0),roShow(e,a,r)):a?masterSoDoNext(e,r):(addCardToFailedPseudoCardCache(t),disableCard(t))}function roShow(e,a,r){var t=getCardById(e,r).tmplItem().data.trkId,s=getCardAndCheckUpdateHtml(a,"ro",e,r),d=roArray[roCurrent],o="Earn "+d.amountinfo,i=addToVirtualCardsDef(cardsInfo.typeIds.ro,getRealCardPos(s),d.id,d.title,d.link,t);roArray.splice(roCurrent,1),d.link+="&trackId="+t;for(var n=0,l=d.images.length;n<l;n++){if(125==d.images[n].width){d.images[n];break}n==d.images.length&&d.images[n]}setPseudoCardImg(e,cardsInfo.typeIds.ro),$("#"+cardProps.cardHeaderId+e).html(o),sbCards.asyncUpdatePayout(e,sbHelpers.formatNumbersWithCommas(d.amount)),d.types.indexOf("Video")>-1?s.data({clickFnSoNewWinPopGen:!0,offerPop:{url:"/?cmd=gn-so-gen-frame&url="+encodeURIComponent(d.link)+"&w=300&h=250&p=ro&cardid="+e,params:"status=0,toolbar=0,scrollbars=0,width=300,height=250,resizable=disallow"}}):s.data({clickFnSoNewWinPopGen:!1,lnk:d.link}),s.data({header:o,subHeader:pEncodeHtml(d.title)+d.description,earn:sbHelpers.formatNumbersWithCommas(d.amount),moreInfo:d.requirements,master:a,virtualDef:i}),a&&masterSoCardsStartNext(),showHiddenCard(s)}function roClick(e){var a=getCardById(e.cardId).data();a.clickFnSoNewWinPopGen?soOpenWinDo(a.offerPop.url,a.offerPop.params):soOpenWinDo(a.lnk,""),virtualClicked(a)}function roClosed(e){var a=getCardById(e),r=a.data("master");roJson.length>0?(roCurrent=Math.floor(Math.random()*roJson.length),roShow(e,r)):(roAvai=!1,r?masterSoDoNext(e):(addCardToFailedPseudoCardCache(a),disableCard(a)))}var viroolCalled=!1,viroolArray=[],viroolAvai=!1,viroolLoaded=!1,viroolCurrent=0;function viroolInit(){viroolCalled||(viroolCalled=!0,pLoadScript(viroolCall))}function onViroolJson(e){e.data&&e.data.offers&&e.data.offers.length>0&&(viroolAvai=!0,viroolArray=e.data.offers),viroolLoaded=!0}function viroolDo(e,a,r){if(isBLockedOfferProvider("virool")){a?masterSoDoNext(e,r):(addCardToFailedPseudoCardCache(t=getCardById(e,r)),disableCard(t))}else{viroolInit();var t=getCardById(e,r);if(viroolLoaded)viroolGo(e,a,r,t);else{disableCard(t,!0);var s=setInterval((function(){viroolLoaded&&(clearInterval(s),viroolGo(e,a,r,t))}),100)}}}function viroolGo(e,a,r,t){viroolAvai&&viroolArray.length>0?(viroolCurrent=Math.floor(Math.random()*viroolArray.length),disableCard(t,!0,!0),viroolShow(e,a,r)):a?masterSoDoNext(e,r):(addCardToFailedPseudoCardCache(t),disableCard(t))}function viroolShow(e,a,r){var t=viroolArray[viroolCurrent],s=getCardAndCheckUpdateHtml(a,"virool",e,r),d=addToVirtualCardsDef(cardsInfo.typeIds.virool,getRealCardPos(s),t.campaignId,t.description,t.url,getCardById(e,r).tmplItem().data.trkId);viroolArray.splice(viroolCurrent,1),setPseudoCardImg(e,cardsInfo.typeIds.virool),$("#"+cardProps.cardHeaderId+e).html(t.description),sbCards.asyncUpdatePayout(e,t.reward),s.data({header:t.description,subHeader:$.trim(t.descriptionFull),earn:t.reward,master:a,virtualDef:d,offerPop:{url:"/?cmd=gn-so-gen-frame&url="+encodeURIComponent(t.url)+"&w="+t.width+"&h="+t.height+"&p=virool&cardid="+e,params:"status=0,toolbar=0,scrollbars=0,width="+t.width+",height="+t.height+",resizable=disallow"}}),a&&masterSoCardsStartNext(),showHiddenCard(s)}function viroolClosed(e){var a=getCardById(e),r=a.data("master");viroolArray.length>0?(viroolCurrent=Math.floor(Math.random()*viroolArray.length),viroolShow(e,r)):(viroolAvai=!1,r?masterSoDoNext(e):(addCardToFailedPseudoCardCache(a),disableCard(a)))}function ngageDo(e,a,r){if(a)masterSoDoNext(e,r);else{var t=getCardById(e,r);addCardToFailedPseudoCardCache(t),disableCard(t)}}function frontendDo(e,a,r){switch(r.relatedID){case 58:buzzDo(e,a,r);break;case 137:case-2:case-4:ngageDo(e,a,r);break;case 78:case-3:sbCards.danielDo(e,a,r);break;case 35:peanutDo(e,a,r)}}sbCards.danielDo=function(e,a,r){if(a)masterSoDoNext(e,r);else{var t=getCardById(e,r);addCardToFailedPseudoCardCache(t),disableCard(t)}};var spaceJetCalled=!1,spaceJetAvai=!1,spaceJetJson=new Array,spaceJetLoaded=!1,spaceJetCurrent=0;function spaceJetInit(){spaceJetCalled||(spaceJetCalled=!0,pLoadScript(spaceJetCall))}function onSpaceJetJson(e){(spaceJetJson=e).length>0&&(spaceJetAvai=!0),spaceJetLoaded=!0}function spaceJetDo(e,a,r){if(isBLockedOfferProvider("SpaceJet")){a?masterSoDoNext(e,r):(addCardToFailedPseudoCardCache(t=getCardById(e,r)),disableCard(t))}else{spaceJetInit();var t=getCardById(e,r);if(spaceJetLoaded)spaceJetGo(e,a,r,t);else{disableCard(t,!0);var s=setInterval((function(){spaceJetLoaded&&(clearInterval(s),spaceJetGo(e,a,r,t))}),100)}}}function spaceJetGo(e,a,r,t){spaceJetAvai&&spaceJetJson.length>0?(spaceJetCurrent=Math.floor(Math.random()*spaceJetJson.length),disableCard(t,!0,!0),spaceJetShow(e,a,r)):(spaceJetAvai=!1,a?masterSoDoNext(e,r):(addCardToFailedPseudoCardCache(t),disableCard(t)))}function spaceJetShow(e,a,r){var t=getCardById(e,r),s=t.tmplItem().data.trkId,d=spaceJetJson[spaceJetCurrent];spaceJetJson.splice(spaceJetCurrent,1);var o=d.Title,i=d.URL.replace("{trackingid}",s),n=d["SB Amount"],l=d.Height,c=d.Width,C=addToVirtualCardsDef(cardsInfo.typeIds.spaceJet,getRealCardPos(t),0,o,i,s);sbCards.asyncUpdatePayout(e,n),$("#"+cardProps.cardHeaderId+e).html(o),sbGlbl.objCards.setCardImage(e,d["Image URL"]),t.data({header:o,subHeader:d.Description,earn:n,master:a,virtualDef:C,link:i,trkid:s,closeCardOnOpen:spaceJetClosed,uom:d.UOM,offerPop:{url:"/?cmd=gn-so-gen-frame&url="+encodeURIComponent(i.replace(/&amp;/g,"&"))+"&w="+c+"&h="+l+"&p=spaceJet&cardid="+e,params:"status=0,toolbar=0,scrollbars=0,width="+c+",height="+l+",resizable=disallow"}}),$.extend(t.tmplItem().data,t.data()),a&&masterSoCardsStartNext(),showHiddenCard(t)}function spaceJetClosed(e){var a=getCardById(e),r=a.data("master");spaceJetAvai&&spaceJetJson.length>0?"CPC"==a.tmplItem().data.uom&&(spaceJetCurrent=Math.floor(Math.random()*spaceJetJson.length),spaceJetShow(e,r)):(spaceJetAvai=!1,r?masterSoDoNext(e):(addCardToFailedPseudoCardCache(a),a.remove()))}var revUverseCalled=!1,revUverseArray=[],revUverseAvai=!1,revUverseLoaded=!1,revUverseCurrent=0;function revUverseInit(){revUverseCalled||(revUverseCalled=!0,pLoadScript(revUverseCall))}function onRevUverseJson(e){"[object Object]"!=Object.prototype.toString.call(e)||$.isEmptyObject(e)||(revUverseAvai=!0,revUverseArray.push(e)),revUverseLoaded=!0}function revUverseDo(e,a,r){if(isBLockedOfferProvider("revUverse")){a?masterSoDoNext(e,r):(addCardToFailedPseudoCardCache(t=getCardById(e,r)),disableCard(t))}else{revUverseInit();var t=getCardById(e,r);if(revUverseLoaded)revUverseGo(e,a,r,t);else{disableCard(t,!0);var s=setInterval((function(){revUverseLoaded&&(clearInterval(s),revUverseGo(e,a,r,t))}),100)}}}function revUverseGo(e,a,r,t){revUverseAvai&&revUverseArray.length>0?(revUverseCurrent=Math.floor(Math.random()*revUverseArray.length),disableCard(t,!0,!0),revUverseShow(e,a,r)):a?masterSoDoNext(e,r):(addCardToFailedPseudoCardCache(t),disableCard(t))}function revUverseShow(e,a,r){var t=revUverseArray[revUverseCurrent],s=getCardAndCheckUpdateHtml(a,"revUverse",e,r),d=s.tmplItem().data.trkId,o=addToVirtualCardsDef(cardsInfo.typeIds.revUverse,getCardPos(s),"",t.Description,t.URL,d),i=t.Title;revUverseArray.splice(revUverseCurrent,1),sbGlbl.objCards.setCardImage(e,t["Image URL"]),$("#"+cardProps.cardHeaderId+e).html(i),sbCards.asyncUpdatePayout(e,t["SB Amount"]),s.data({header:i,subHeader:t.Description,disclaimer:t.Disclaimer,earn:t["SB Amount"],master:a,virtualDef:o,link:withAmpOrQuestion(t.URL)+"sid3="+(d||""),aboutHeading:"Details"}),$.extend(s.tmplItem().data,s.data()),a&&masterSoCardsStartNext(),showHiddenCard(s)}function revUverseClosed(e){var a=getCardById(e),r=a.data("master");revUverseArray.length>0?(revUverseCurrent=Math.floor(Math.random()*revUverseArray.length),revUverseShow(e,r)):(revUverseAvai=!1,r?masterSoDoNext(e):(addCardToFailedPseudoCardCache(a),disableCard(a)))}function gameCustomFn(e){sbCards.asyncUpdatePayout(e.cardId,10,!0)}function merchantCardsCustomTmplFn(e,a){specificStream||(a=getCardById(e.cardId));var r=0,t=e.trayId;if(5==t&&(r=41),109==t?r=122:18==t?r=8:sbGlbl.currentShopCategoryID?r=void 0!==e.coAd&&e.coAd?e.pos+69:5:21==t||162==t?r=105:22==t?r=7:20==t?r=-e.pos-1:"/shop/featured"===window.location.pathname&&t===sbCards.objTrays.featuredMerchants?r=322:19==t?r=108:108==t?r=112:100==t?r=106:99==t?r=107:158==t?r=247:159==t?r=248:160==t?r=249:161==t?r=250:specificStream&&initialCardLoad.isShopPromoTray||e.isShopPromoTray?r=113:sbGlbl.isHome&&t===sbCards.objTrays.featuredMerchants?r=291:sbGlbl.isHome&&t===sbCards.objTrays.shopAndEarn?r=122:sbGlbl.isHome&&[sbCards.objTrays.amazonStoreCA,sbCards.objTrays.amazonStoreUS].includes(t)?r=288:[sbCards.objTrays.shopPromotion1,sbCards.objTrays.shopPromotion2,sbCards.objTrays.shopPromotion3].includes(t)&&(r=sbGlbl.isHome&&sbCards.objTrays.shopPromotion1?327:297),a.tmplItem().data.link){var s="page="+r,d={page:r};sbGlbl.currentShopCategoryID&&(s+="&category="+sbGlbl.currentShopCategoryID,d.category=sbGlbl.currentShopCategoryID),a.tmplItem().data.appendToLink=s,a.tmplItem().data.objAppendToLink=d}}function showSbtvWatch(e){$cardBtm=getCardById(e.cardId).find(".cardSublayer"),$.tmpl(sbtvMeterTmpl,{vidsUntilWin:e.toWin,isPlural:1!=e.toWin?"s":""}).appendTo($cardBtm)}function setPseudoCardImg(e,a){return sbGlbl.objCards.setCardImage(e,getImgByType(a)).css("backgroundImage")}function setPseudoCardTitle(e,a){return $("#"+cardProps.cardHeaderId+e).html(getTitleByType(a)).html()}function setPseudoCardDesc(e,a){return getDescByType(a)}function getImgByType(e){var a=cardInfo[e];if(a&&a.imgs){var r=sbGlbl.gAppContent+"/content/home-6/images/defaults/";void 0===a.imgUsed&&(a.imgUsed=[]),a.imgs.length||(a.imgs=a.imgUsed);var t=a.imgs.shift();return a.imgUsed.push(t),r+a.imgPrefix+t+".jpg?v=2"}}function getTitleByType(e){var a=cardInfo[e];if(a&&a.titles){void 0===a.titleUsed&&(a.titleUsed=[]),a.titles.length||(a.titles=a.titleUsed);var r=a.titles.shift();return a.titleUsed.push(r),r}}function getDescByType(e){var a=cardInfo[e];if(a&&a.desc){void 0===a.descUsed&&(a.descUsed=[]),a.desc.length||(a.desc=a.descUsed);var r=a.desc.shift();return a.descUsed.push(r),r}}var cardSort=sbGlbl.cardSort,cardFilters=-1,allFilters=0,filteringOrSortingCards=!1,canFilterOrSort=!1,failedPseudoCardCache={},$sortListWrap=$("#sortListMenuWrap"),$sortList=$("#sortListMenu"),$sortListOptions=$sortList.children("span"),sortListIsVisible=!1,$filteringOrSortingWrap=$(),filterTimer=null,cardsRealCount=0,$filterIcons=$(".filterIcon"),xtraPseudoCardCache=$(),isFiltering,isSorting,$filterIconsCont=$("#filterIconsContainer"),$filterIconsCollection=$(".filterIcon"),filtersData={shop:{cond:[30,31,32,39],ntfClass:["isShopEarnCard"],canFilter:!1,flag:1},watch:{cond:[2],ntfClass:["isSBTVCard"],canFilter:!1,flag:2},answer:{cond:[15,16,29,35,37,50],ntfClass:["isSurveyCards","isPollsCard"],canFilter:!1,flag:4},offers:{cond:[3,10,11,12,13,14,17,18,19,21,22,23,25,26,28],ntfClass:["isSpecialOffersCard"],canFilter:!1,flag:8},coupons:{cond:[4],ntfClass:["isCouponsCard"],canFilter:!1,flag:16},play:{cond:[5],ntfClass:["isGamesCard"],canFilter:!1,flag:32}},filterFlags={shop:1,watch:2,answer:4,offers:8,coupons:16,play:32};function updateCardsRealCount(e){cardsRealCount=e}function getCardsRealCount(){return cardsRealCount}function cardContainsClassInArray(e,a){for(var r=0;r<e.length;r++)if($.inArray(e[r],a)>-1)return!0;return!1}function checkCardTypeConditions(e,a){for(var r in filtersData)void 0===filtersData[r]||filtersData[r].canFilter||(8==a?cardContainsClassInArray(e.attr("class").split(" "),filtersData[r].ntfClass)&&(filtersData[r].canFilter=!0):$.inArray(a,filtersData[r].cond)>-1&&(filtersData[r].canFilter=!0))}function createPseudoCardStr(e){var a=e?xtraPseudoCardCache:getSuccessfulPsuedoCardsCollection();if(!a)return"";var r,t,s,d=[];return a.each((function(){s=$(this),r=s.tmplItem().data,t=r.cardId+","+r.cardTypeId+","+s.data("earnAmt"),d.push(t)})),d.join(";")}function setCardSort(e){cardSort=e}function updateCardPositions(e){if(e){var a=0,r=getSbHomeCards().filter((function(){return(a=$(this).data("pos"))||(a=$(this).tmplItem().data.pos),a>e.pos})),t=0;r.each((function(){t=getCardPos($(this));getCardPos($(this));$(this).data("pos",--t)}))}}function appendPseudoCardFromCache(e,a){e&&(e.tmplItem().data.trkId=e.data().virtualDef.trkId=a,e.appendTo("#"+cardProps.cardWrapperId).data("hdnLoaded",!0).addClass("showHomeCard").removeClass("hiddenCard"))}function clearHiddenCardTimers(){for(var e=0;e<hiddenCardTimers.length;e++)clearTimeout(hiddenCardTimers[e])}function getFilterTypeName(e){return e.attr("data-filter-name")}function addCardFilter(e,a){var r="Hide "+getFilterTypeName(a);a.data("on",!0).attr("data-tooltip-content",r).children("span").removeClass("filterInactive").addClass("filterActive"),cardFilters|=e,$("#newTooltip").hide()}function removeCardFilter(e,a){var r="Show "+getFilterTypeName(a);a.data("on",!1).attr("data-tooltip-content",r).children("span").removeClass("filterActive").addClass("filterInactive"),cardFilters&=~e,$("#newTooltip").hide()}function filterCards(e){}function disableEmptyFilters(){var e=getSbHomeCards();e.each((function(){$(this).tmplItem().data.cardTypeId})),$filterIcons.not(".filterHide").each((function(){filtersData[$(this).attr("data-filter-type")].canFilter,enableFilter($(this))}))}function disableFilter(e){e.data("filterActive",!1).children("span").removeClass("filterActive").addClass("filterNull")}function enableFilter(e){e.data("filterActive",!0).children("span").removeClass("filterNull").addClass(e.data("on")?"filterActive":"")}function disableActiveFilters(){$filterIcons.filter((function(){return $(this).data("filterActive")})).children("span").removeClass("filterActive").addClass("filterNull")}function enableActiveFilters(){$filterIcons.filter((function(){return $(this).data("filterActive")})).children("span").removeClass("filterNull").addClass("filterActive")}function filterFlagIsOn(e){return 0!=(cardFilters&e)}function passedCardFilterFlag(e){var a=e.tmplItem().data.cardTypeId,r=!1;for(var t in filtersData)if(8==a?cardContainsClassInArray(e.attr("class").split(" "),filtersData[t].ntfClass)?filterFlagIsOn(filtersData[t].flag)&&(r=!0):r=!0:$.inArray(a,filtersData[t].cond)>-1&&filterFlagIsOn(filtersData[t].flag)&&(r=!0),r)break;return r}function getAllPseudoCards(){var e=0;return getSbHomeCards().filter((function(){return e=$(this).tmplItem().data.cardTypeId,$.inArray(e,cardsInfo.templatedVirtual)>-1&&$.inArray(e,cardsInfo.typeIds.soMaster)<0}))}function getSuccessfulPsuedoCards(){return successfulPseudoCardCache.length||populateSuccessfulPseudoCardsCache(),successfulPseudoCardCache}function getSuccessfulPsuedoCardsCollection(){return successfulPseudoCardCollection.length||populateSuccessfulPseudoCardsCache(),successfulPseudoCardCollection}function getSbHomeCards(){return specificStream?$("#"+cardProps.cardWrapperId).find("."+(sbGlbl.isListView?cardProps.cardListViewSelector:cardProps.cardClass)).not(".premiumBannerWrap, .toutCard, .sbCustomHomeCard, ."+cardProps.disabledTemporarilyCardClass+", ."+cardProps.favoritesTrayNullCaseCardProps.cardTypeId):$("."+cardProps.traySelector).find("."+cardProps.cardClass).not(".premiumBannerWrap, .toutCard, .sbCustomHomeCard, ."+cardProps.disabledTemporarilyCardClass+", ."+cardProps.favoritesTrayNullCaseCardProps.cardTypeId)}function getdbCards(e){var a=$(),r=[];return getSuccessfulPsuedoCardsCollection().each((function(){r.push($(this).attr("id"))})),e.each((function(){$.inArray($(this).attr("id"),r)<0&&(a=a.add($(this)))})),a}var failedPseudoCardTypeCache=[];function removeCardFromPseudoCardCache(e){delete successfulPseudoCardCache[e]}function addCardToFailedPseudoCardCache(e){!specificStream&&Trays.get(e.tmplItem().data.trayId)&&Trays.get(e.tmplItem().data.trayId).removeItem(e),failedPseudoCardCache[e.tmplItem().data.cardId]=e,$.inArray(e.tmplItem().data.cardTypeId,failedPseudoCardTypeCache)<0&&failedPseudoCardTypeCache.push(e.tmplItem().data.cardTypeId)}function isFailedCardType(e){return $.inArray(e,failedPseudoCardTypeCache)>-1}function populateSuccessfulPseudoCardsCache(){var e,a={},r=($(),$());getAllPseudoCards().each((function(){if($jqCard=$(this),e=$jqCard.tmplItem().data,a[e.cardId]={},!(e.cardId in failedPseudoCardCache)&&!(e.cardId in successfulPseudoCardCache)){var t=$("#cardSBValueAmt"+e.cardId).html();t=t?parseInt(t.replace(/,/g,"")):0,$jqCard.data("earnAmt",isNaN(t)?0:t),$jqCard.data("hdnLoaded")&&(successfulPseudoCardCache[e.cardId]={card:$jqCard},r=r.add($jqCard))}})),successfulPseudoCardCollection=successfulPseudoCardCollection.add(r),$.extend(!0,successfulPseudoCardCache,a)}function updatExtraPsuedoCardCache(){xtraPseudoCardCache=$();var e=getCardsRealCount(),a=cardsInfo.cards.length;if(a>e){var r=$();r=cardsInfo.cards.splice(e,a);for(var t=0;t<r.length;t++)xtraPseudoCardCache=xtraPseudoCardCache.add(successfulPseudoCardCache[r[t].cardId].card);cardsInfo.cards=cardsInfo.cards.splice(0,a)}}function removeXtraCards(){getSbHomeCards().length>getCardsRealCount()&&(xtraPseudoCardCache.detach(),cardsInfo.cards=cardsInfo.cards.splice(0,getCardsRealCount()))}function appendExtraCards(){xtraPseudoCardCache.each((function(){var e=$(this);passedCardFilterFlag(e)&&appendPseudoCardFromCache(e)}))}function showCardsAfterFilterOrSort(e){getSuccessfulPsuedoCardsCollection().detach(),getdbCards(getSbHomeCards()).remove();updatExtraPsuedoCardCache(),getCards(0,!1),appendExtraCards()}function updateFilterMsg(e,a){var r=a.attr("data-filter-type"),t=r.charAt(0).toUpperCase()+r.slice(1);"Offers"==t&&(t="Offer"),$("#"+r+"LoadMsg").html((e?"Showing ":"Hiding ")+t+" Cards").show()}function updateSortingMsg(){$("#sortingByMsg").html("Sorting By "+sortTypeNameMap[parseInt(cardSort-1)])}function hideFilterMsgs(){$(".loadMsgs").hide()}function setUpLoadingMsgs(){var e="";$("#filterSortContainer").find(".filterIcon").each((function(){e+='<div id="'+$(this).attr("data-filter-type")+'LoadMsg" class="loadMsgs"></div>'})),$filteringOrSortingWrap.append('<div id="loadingMsgsWrap"></div>'),$("#loadingMsgsWrap").append(e+'<div id="sortingByMsg">Sorting By '+sortTypeNameMap[parseInt(cardSort-1)]+"</div>")}function showLoader(){if(createdSpinner)return createdSpinner.spin(),void $filteringOrSortingWrap.prepend(createdSpinner.el);return(createdSpinner=new Spinner({lines:13,length:4,width:8,radius:30,corners:1,rotate:0,direction:1,color:"#555",speed:2,trail:100,shadow:!1,hwaccel:!1,className:"sortAndFilterSpinner"})).spin(),$filteringOrSortingWrap.append(createdSpinner.el),createdSpinner}function hideLoader(){createdSpinner.stop()}function sortOrFilter(type){1==type?isFiltering=!0:2==type&&(isSorting=!0),clearTimeout(filterTimer),filterTimer=null,$filteringOrSortingWrap.fadeIn(150,(function(){showLoader(),filterTimer=setTimeout((function(){clearTimeout(filterTimer),filterTimer=null,filteringOrSortingCards=!0;var $cards=$(".sbHomeCard");isFirstSort&&(isFirstSort=!1),populateSuccessfulPseudoCardsCache();var tmpCount=getCardsRealCount(),data={h:cardHash,pseudoCards:createPseudoCardStr()};$.post("/?cmd=card-jx-get&sort="+cardSort+"&filters="+cardFilters+"&count="+tmpCount+"&startindex=0",data,(function(resp){hideFilterMsgs(),isSorting=!1,isFiltering=!1;var respInfo=resp;if("1"===respInfo.charAt(0)){var respObj=eval("("+respInfo.substring(2)+")");cardsInfo.cards=respObj.cards,nextCardIndex=respObj.nextIndex,updateCardsRealCount(tmpCount),undoDoNoMoreCards(),showCardsAfterFilterOrSort(tmpCount),$filteringOrSortingWrap.fadeOut(150),hideLoader(),alreadyTrackedCache=[],setTimeout(trackCardsInView,1e3)}else if("0"===respInfo.charAt(0)&&"LOGIN"==respInfo.substring(2))return;filteringOrSortingCards=!1}))}),1e3)}))}function hasActiveFilters(){var e=!1;return $filterIcons.each((function(){if($(this).data("on"))return e=!0,!1})),e}$filterIcons.bind("click",(function(){if($filterAndSortContainer.is(":visible")&&!filteringOrSortingCards&&$(this).data("filterActive")){trackEvnt("HP Cards Filter",$.trim($(this).attr("data-tooltip-content")));var e=filterFlags[$(this).attr("data-filter-type")];!$(this).data("on")?(addCardFilter(e,$(this)),updateFilterMsg(!0,$(this))):(updateFilterMsg(!1,$(this)),removeCardFilter(e,$(this))),reloadTooltips(),sortOrFilter(1)}})),$sortListOptions.bind("click",(function(){!$filterAndSortContainer.is(":visible")||filteringOrSortingCards||$(this).hasClass("isActiveSelectMenuItem")||(setCardSort($(this).attr("data-sort-type")),sortOrFilter(2),updateSortingMsg())}));var $sortbyTxt=$sortListWrap.find(".sortByText");$sortListWrap.bind("click",(function(e){e.stopPropagation(),sortListIsVisible?hideSortList():showSortList()}));var child=$sortList.children("span"),childHeight=child.outerHeight();function hideSortList(){$sortList.fadeOut("fast",(function(){sortListIsVisible=!1}))}function showSortList(){$sortList.fadeIn("fast",(function(){sortListIsVisible=!0}))}function setSelectMenuItemAsActive(e){e.addClass("isActiveSelectMenuItem").siblings(".isActiveSelectMenuItem").removeClass("isActiveSelectMenuItem")}function setSelectMenuOffset(e,a){var r=$sortList.children('span[data-sort-type="'+a+'"]');$sortListWrap.find(".sortByText").attr("data-cur-order",r.index()),setSelectMenuItemAsActive(r)}function updatePremiumCardInfo(){var e,a,r=premiumNtfInfo[0],t=$("#sbPremiumOfferCard"),s=t.attr("id");$.extend(t.tmplItem().data,{ntfId:r.id,ntfTypeId:r.cardTypeID});var d=r.json.link,o=d.indexOf("rurl=")+5,i=!1;if(o>5){var n=d.indexOf("&",o);n>0&&(e=d.substring(o,n),a=d.substring(n),i=!0)}i||(e=d,a="");var l=addToVirtualCardsDef(cardsInfo.typeIds.ntf,0,r.id,r.json.header,e,t.tmplItem().data.trkId);t.data({master:!1,virtualDef:l,closeUrl:r.closeLnk,finalLnk:e,targetBlank:r.json.targetBlank,ntfData:a});var c=r.json.impressionScript;c&&(sbHelpers.isScriptUrl(c)?sbHelpers.injectImpressionScriptTag(c,s,t):$("<div/>").attr("id","card-impression-pixel"+s).addClass("isPixel").html(c).appendTo("body"))}function premiumCardClicked(e){var a=$("#sbPremiumOfferCard"),r=a.data("targetBlank"),t=a.data("finalLnk"),s=a.data("ntfData"),d=a.data("virtualDef");d.h=cardHash;var o=r?window.open(""):window;$.post("/?cmd=card-pseudo-click"+s,d,(function(e){var a=e.split("|");a.length>1&&"0"==a[1]?(o.location="/?cmd=dr-offer-unavailable",o.focus()):(o.location=decodeURIComponent(t),o.focus())}))}function trackEvnt(e,a){e&&a&&"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent",$.trim(e),$.trim(a)])}function fulcrumSurveyCustomTmplFn(e,a){void 0!==a&&a instanceof jQuery&&a.length||(a=getCardById(e.cardId,e)),a.find(".cardTimeRemaining").first().append("&nbsp;min.");var r=a.tmplItem().data,t=r.link;"string"==typeof t&&"="==t.charAt(t.length-1)&&(r.link+=LINK_SOURCE_HOMEPAGE)}setSelectMenuOffset(childHeight,$sortbyTxt.attr("data-cur-order")),$sortList.children("span").bind("click",(function(e){e.stopPropagation(),setSelectMenuItemAsActive($(this));var a=$(this).attr("data-sort-type");setSelectMenuOffset($(this).outerHeight(),a),hideSortList(),$sortListWrap.find(".sortByText").html($(this).html())})),$crdsWin.bind("keyup",(function(e){var a=e.keyCode||e.which;sortListIsVisible&&27==a&&hideSortList()})),$cardsBod.bind("click",hideSortList),$filterIcons.each((function(){$(this).data("on",!0)})),allFilters=cardFilters,function(){$filterIconsCollection.eq(0).addClass("filterFirst").end().last().addClass("filterLast");var e=$filterIconsCollection.length>2?parseInt($filterIconsCollection.first().css("marginRight"))+parseInt($filterIconsCollection.last().css("marginLeft")):0;$filterIconsCont.width($filterIconsCollection.eq(1).outerWidth(!0)*$filterIconsCollection.length-e)}(),$((function(){setTimeout((function(){$filterAndSortContainer.animate({opacity:1},{duration:150,complete:function(){initNewTooltip({elm:"#filterIconsContainer"}),$filterAndSortContainer.addClass("sortIsVisible")},queue:!1}),canFilterOrSort=!0,disableEmptyFilters()}),2e3),$("#onboardingDeckContainer").append('<div id="filteringOrSortingCardsWrap"></div>'),$filteringOrSortingWrap=$("#filteringOrSortingCardsWrap"),showLoader(),setUpLoadingMsgs()}));var callNum=0,allowCardTracking=!1,cardHeightNegativeThreshold=20,$cardWrapper=$(),topbarHeight=0,isSendingCardsInViewTracker=!1,alreadyTrackedCache=[],$tempCardsInViewCollection=$(),$trackedCardsBeforeLoad=$();function getTopBarHeight(){return topbarHeight>0?topbarHeight:$("#sbGlobalNav").outerHeight(!0)+$("#confirmEmailBarOuter").outerHeight(!0)}function getCardsPerRow(){return Math.floor($("#"+cardProps.cardWrapperId).width()/233)}function getRealCardPos(e){return e&&e.length?e.prevAll(":visible").length+$(".premiumBannerWrap:visible").length+1:-1}function getCardCol(e){"use strict";var a=getRealCardPos(e),r=sbCards.getTrayRowsCount(e);if(specificStream||1===r){var t=a%getCardsPerRow();return t>0?t:getCardsPerRow()}return Math.ceil(a/r)}function getCardRow(e){"use strict";var a=getRealCardPos(e),r=sbCards.getTrayRowsCount(e);if(specificStream||1===r)return Math.ceil(a/getCardsPerRow());var t=a%r;return 0===t?r:t}function elmIsAboveTheTop(e){return $crdsWin.scrollTop()+getTopBarHeight()+cardHeightNegativeThreshold>e.offset().top}function elmIsBelowTheFold(e,a){var r=a||cardHeightNegativeThreshold,t=sbGlbl.objCards.getCardsWrapper();if(!t.length){sbGlbl.objCards.getCardsAlternativeWrappers();var s=sbGlbl.objCards.$cardsPagePrimaryAlternativeWrapper,d=sbGlbl.objCards.$cardsPageSecondaryAlternativeWrapper;t=s.outerHeight()>d.outerHeight()?s:d}return!sbCards.isGlobalSearch&&$crdsWin.height()+$crdsWin.scrollTop()+r-t.offset().top<e.offset().top}function elmIsOutLeft(e){return e.get(0).getBoundingClientRect().left<0}function elmIsOutRight(e){return e.get(0).getBoundingClientRect().right>$(window).width()}function isElmInView(e){return!(elmIsBelowTheFold(e)||elmIsAboveTheTop(e)||elmIsOutLeft(e)||elmIsOutRight(e))}function getCardsPerCol(){var e=getSbHomeCards().filter((function(){return isElmInView($(this))&&!$(this).hasClass("hiddenCard")}));return Math.ceil(e.length/getCardsPerRow())}function createTrackingStringDb(e){var a=[];return e.each((function(){$(this).tmplItem().data.cardId>0&&a.push([$(this).tmplItem().data.cardId,$(this).data("accuratePos"),$(this).data("column"),$(this).data("row"),$(this).tmplItem().data.trkId])})),a.length?a.join(";"):""}function createTrackingStringPseudo(e){var a,r=[];return e.each((function(){a="",$(this).tmplItem().data.pseudoCardType&&(a=createVirtualDefStr($(this).data())),a&&r.push(a)})),r.length?r.join("@rd@"):""}!function(e){function a(a){$cardWrapper.length||($cardWrapper=e("#onboardingDeckContainer"));var s=getSbHomeCards().filter(r);return allowCardTracking?(a&&(s=s.add($trackedCardsBeforeLoad)),function(a){for(var r=0,s=a.length;r<s;r++)a[r]=t(e(a[r]));return a}(s)):s}function r(a,r){return sbHelpers.isVisible(r)&&e(r).isOnScreen()&&!sbHelpers.hasAnyClass(r,[cardProps.hiddenCardClass,cardProps.premiumCardClass,cardProps.notTrackableCardClass,cardProps.toutCardClass,cardProps.fbLikeCardClass])&&!alreadyTrackedCache.includes(r.id)}function t(e){return e.data({accuratePos:getRealCardPos(e),column:getCardCol(e),row:getCardRow(e)})}function s(e,a,r){setTimeout(d.bind(null,e,a,r),0)}function d(e,a,r){var t=window.cardProps,s=document.getElementById(t.cardEarnAmountId+e);if(s){var d=s.parentElement,o=d.querySelector(t.cardStaticPayoutAmountSelector),i=document.createDocumentFragment();r&&i.append("Up to "),i.append(window.sbHelpers.wrapTextWithTag("var",a+" SB")),s.innerHTML="",s.append(i),d.classList.remove(t.cardEarnContainerNotActiveClass),o&&o.remove()}}window.getCardsInView=a,sbCards.asyncUpdatePayout=s}(jQuery);var forceAllowTracking=!0;function getTraysLen(){var e=0;return $.each(Trays,(function(a,r){sbHelpers.isNumeric(a)&&e++})),e}function fireCustomImpressionPixel(e){$("<img/>",{src:e}).addClass("isPixel").appendTo("body")}function trackCardsInView(){if(!isSendingCardsInViewTracker&&(allowCardTracking||forceAllowTracking))if(!forceAllowTracking&&allowCardTracking){if($trackedCardsBeforeLoad.length&&allowCardTracking?($tempCardsInViewCollection=getCardsInView(!0).add($trackedCardsBeforeLoad.filter(":visible")),$trackedCardsBeforeLoad=$()):$tempCardsInViewCollection=getCardsInView(),$tempCardsInViewCollection.length){isSendingCardsInViewTracker=!0;var e={first:0===callNum,width:getCardsPerRow(),height:getCardsPerCol(),cards:[]};$.each($tempCardsInViewCollection,(function(){var a=$(this),r=a.data(),t=r.cardTypeId!=cardProps.intFrontEndCardTypeId&&void 0!==r.pseudoCardType,s={pseudo:t,cardTypeId:r.cardTypeId,streamId:r.trayId,trkId:r.trkId};if(specificStream)s.column=r.column,s.row=r.row,s.cardPos=r.accuratePos,s.trayPos=-1;else{var d=r.trayId;if(!sbHelpers.isNumeric(d))return;var o=sbCards.getTrayProperties(d),i=-1;if(s.column=getCardCol(a),s.row=getCardRow(a),s.cardPos=a.index(),sbHelpers.isObject(o)){var n=o.trayPos;sbHelpers.isNumeric(n)&&(i=n)}s.trayPos=i}if(t){var l=r.virtualDef;if(!l)return;s.offerID=l.offerId,s.text=l.cardText,s.url=encodeURIComponent(l.cardUrl)}else s.cardId=r.realCardId;r.customImpressionPixel&&fireCustomImpressionPixel(r.customImpressionPixel);var c=r.impressionScript;c&&isShopCardType(r.cardTypeId)&&(sbHelpers.isScriptUrl(c)?sbHelpers.injectImpressionScriptTag(c,r.cardId,a):$("<div/>").attr("id","card-impression-pixel"+r.cardId).addClass("isPixel").html(c.replace("@MemberID@",soSbMemId)).appendTo("body")),e.cards.push(s)})),$.isEmptyObject(e)||(e=Object.assign(e,sbCards.addTrayCardsViewedMetadata()),$.ajax({url:"/?cmd=card-jx-tray-viewed",data:{impressionData:JSON.stringify(e),h:window.cardHash},type:"POST",success:function(){$tempCardsInViewCollection.each((function(){alreadyTrackedCache.push($(this).attr("id"))})),$tempCardsInViewCollection=$(),0==callNum&&(callNum=1),isSendingCardsInViewTracker=!1}}))}}else $trackedCardsBeforeLoad=$trackedCardsBeforeLoad.add(getCardsInView())}function isShopCardType(e){return[39,43,47].indexOf(e)>-1}sbCards.loadMoreOnScrollApplicable()&&sbPage.$$content.addEventListener("scroll",sbHelpers.debounce(loadMoreOnScroll,250),!1),sbPage.$$content.addEventListener("scroll",sbHelpers.debounce(trackCardsInView,1e3),!1),window.addEventListener("resize",sbHelpers.debounce(trackCardsInView,1e3),!1),$((function(){setTimeout((function(){allowCardTracking=!0,forceAllowTracking=!1,($trackedCardsBeforeLoad.length||/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent))&&trackCardsInView()}),3500)}));var cardInfoTipsTemplates={},$cardInfoTipWrap;function addCardToTipsCacheOrAndReturnTmpl(e){var a;a=sbCards.isShopSearch||sbCards.isGlobalSearch?e.data("cardId"):e.tmplItem().data.cardId;var r=!1;""==e.data().link&&""!=e.tmplItem().data.link&&(e.data().link=e.tmplItem().data.link);var t=$.extend(e.tmplItem().data,e.data());if(t=sbCards.extendFlyoutDataWithFormattedValues(t),(t=sbCards.extendLinkWithTrayId(t)).merchantId&&t.merchantId===cardProps.intPublishersClearingHouseMerchantId&&(t=sbCards.extendDataCtaPropText(t,cardProps.publishersClearingHouseCtaText)),e.data(t),!(a in cardInfoTipsTemplates))if(r=!0,sbCards.boolUseQuickLook)(cardInfoTipsTemplates[a]=$.tmpl(sbCardDetailsTmpl,t)).appendTo($cardInfoTipWrap).data(t);else if(sbCards.isShopSearch||sbCards.isGlobalSearch){var s;s=sbCards.isShopSearch?sbCards.getCardData(sbCards.shopSearchCards,a):sbCards.getCardData(sbCards.globalSearchCards,a),(s=sbCards.extendFlyoutDataWithFormattedValues(s)).merchantId&&s.merchantId===cardProps.intPublishersClearingHouseMerchantId&&(s=sbCards.extendDataCtaPropText(s,cardProps.publishersClearingHouseCtaText)),(cardInfoTipsTemplates[a]=$.tmpl(hoverDetailsTmpl,s)).appendTo($cardInfoTipWrap).data(s)}else(cardInfoTipsTemplates[a]=$.tmpl(hoverDetailsTmpl,t)).appendTo($cardInfoTipWrap).data(t).hide();return{template:cardInfoTipsTemplates[a],firstTime:r}}function refreshTrayPos(){$.each($("#cardDeck .sbTray"),(function(e,a){var r=parseInt($(a).attr("id").substring(6));Trays.get(r).trayPos=e}))}function repositionStream(e,a){var r=$("#sbTray"+e).detach();$($("#cardDeck > .sbTray")[a]).before(r),refreshTrayPos()}function withAmpOrQuestion(e){return e.indexOf("?")+1?e+"&":e+"?"}function doesCardAlreadyExist(e,a){return $("#sbHomeCard"+e+"-"+a).length>0}function offerToroCardPrepare(e){e.link=sbHelpers.isMember()?e.link.replace("[USER_ID]",sbGlbMember)+e.trkId:GW_URL_QUERY_PARAM}function revenueUniverseCardPrepare(e){e.link=sbHelpers.isMember()?e.link+sbGlbMember:GW_URL_QUERY_PARAM}sbGlbl.objCards.getCardsWrapper=function(){return sbGlbl.objCards.$cardsPageWrapper?sbGlbl.objCards.$cardsPageWrapper:sbGlbl.objCards.$cardsPageWrapper=$("#"+cardProps.cardsPageWrapperId)},sbGlbl.objCards.getCardsAlternativeWrappers=function(){sbGlbl.objCards.$cardsPagePrimaryAlternativeWrapper&&sbGlbl.objCards.$cardsPageSecondaryAlternativeWrapper||(sbGlbl.objCards.$cardsPagePrimaryAlternativeWrapper=$("#"+cardProps.cardsPagePrimaryAlternativeWrapperId),sbGlbl.objCards.$cardsPageSecondaryAlternativeWrapper=$("#"+cardProps.cardsPageSecondaryAlternativeWrapperId))},sbCards.getCardDeck=sbCards.getCardDeck||function(){return sbCards.$cardDeck?sbCards.$cardDeck:sbCards.$cardDeck=$("#"+cardProps.cardDeckSelector)},sbGlbl.objCards.processNtfPlacementCard=function(e,a,r,t){var s=t.$card,d=t.iconType;r="boolean"==typeof r&&r,$.extend(r?getCardById(e,t).tmplItem().data:t,{ntfId:t.id,ntfTypeId:d}),r&&2695==t.id&&$('<img class="isPixel" src="//view.atdmt.com/MRT/view/468782415/direct;wi.1;hi.1/01/" alt="">').appendTo("body");var o,i,n=t.link,l=n.indexOf("rurl=")+5,c=!1;if(l>5){var C=n.indexOf("&",l);C>0&&(o=n.substring(l,C),i=n.substring(C),c=!0)}c||(o=n,i="");var p=addToVirtualCardsDef(cardsInfo.typeIds.ntf,getRealCardPos(s),t.id,t.header,getCardById(e,t).tmplItem().data.trkId),u=ntfCardTypes[d];"object"==typeof u&&s.addClass(void 0!==u.cardIcon?u.cardIcon:"discoverCard "+u.className).data({master:a,virtualDef:p,closeUrl:t.closeLnk,finalLnk:o,targetBlank:t.targetBlank,ntfData:i,cta:u.cta||cardProps.discoverCardDefaultCtaText,aboutHeading:u.aboutHeading||cardProps.discoverCardDefaultAboutHeading}).find("#"+cardProps.cardTypeNameId+e).html(u.text),t.boolIsContinuePlayingCard||s.find("#"+cardProps.cardImgContainerId+e).hasClass(cardProps.answerHeaderClass)||s.find("#"+cardProps.cardHeaderId+e).html(t.header),t.boolIsContinuePlayingCard&&s.find("#"+cardProps.cardTypeNameId+e).html("Continue Playing"),s.data({header:t.header,subHeader:unescape(t.subHeader),specialTerms:t.disclaimer});var f=t.impressionScript;f&&(sbHelpers.isScriptUrl(f)?sbHelpers.injectImpressionScriptTag(f,t.cardId,s):$("<div/>").attr("id","card-impression-pixel"+e).addClass("isPixel").html(r?f:f.replace("@MemberID@",soSbMemId)).appendTo("body")),a&&masterSoCardsStartNext()},sbGlbl.objCards.setCardImage=function(e,a){return $("#"+cardProps.cardImgContainerSelector+e).css("backgroundImage","url("+a+")")},sbGlbl.objCards.closeCardRememberOnClient=function(e){var a=e.$card,r=a.attr("id");if(hideCard(a),setTimeout((function(){trackCardsInView()}),1e3),""!==r){var t,s="arrClosedCards",d=localStorage.getItem(s);if(d){if(t=JSON.parse(d),Array.isArray(t)){if(~t.indexOf(r))return;t.push(r)}}else t=[r];localStorage.setItem(s,JSON.stringify(t))}},sbGlbl.objCards.hadCardBeenClosed=function(e){if(""!==e){var a,r=localStorage.getItem("arrClosedCards");if(!r)return!1;if(a=JSON.parse(r),Array.isArray(a))return!!~a.indexOf(e)}return!1},function(e){var a="."+cardProps.cardClass+", ."+cardProps.cardListViewSelector,r=a+", ."+cardProps.rewardsCardClass,t=!sbHelpers.isMobile()&&!sbHelpers.isAppm()&&(sbHelpers.getType("undefined",sbCards.boolUseFlyout)||sbHelpers.isBoolean(sbCards.boolUseFlyout)&&sbCards.boolUseFlyout);function s(e){var a=e.data().isSuppressModal;return t&&sbHelpers.isFunction(window.showCardInfo)&&sbHelpers.isFunction(window.hideCardInfo)&&!a}cardProps.$doc.delegate(a,"mouseenter",(function(a){var r=e(this);sbCards.boolUseQuickLook?(sbCards.initQuickLook(),0===sbHelpers.getMobileOS()&&r.trigger("click")):(r.hasClass(cardProps.watchCardClass)&&r.find("."+cardProps.watchCardNowPlayingClass).removeClass(cardProps.watchCardNowPlayingHiddenClass).addClass(cardProps.watchCardNowPlayingVisibleClass),s(r)&&showCardInfo(r)),callNum>0||(allowCardTracking||!allowCardTracking&&!$trackedCardsBeforeLoad.length)&&trackCardsInView()})).delegate(a,"mouseleave",(function(a){if(!sbCards.boolUseQuickLook){var r=e(this);if(r.hasClass(cardProps.watchCardClass)&&r.find("."+cardProps.watchCardNowPlayingClass).removeClass(cardProps.watchCardNowPlayingVisibleClass).addClass(cardProps.watchCardNowPlayingHiddenClass),s(r)&&hideCardInfo(r),sbHelpers.hasAnyClass(this,["hiddenCard","sbCustomHomeCard","showPremiumBanner"]))return;var t=cardProps.$tooltip;void 0!==t&&t.hide()}})).delegate(r,"click",(function(a){var r=e(this),t=r.data();if(e.isEmptyObject(t)&&(t=r.children("section").data()),t.offerWallID!==cardProps.TRUEX){var s=r.attr("id").includes("offer_"),d=a.currentTarget.classList.contains("soResult")&&sbCards.specialOfferCard;if(d||!sbCards.boolIsPanGestureActive&&!s){if(sbHelpers.hasAnyClass(this,["hiddenCard","sbCustomHomeCard","sbOnTourCard",cardProps.couponCardClass,cardProps.premiumCardClass]))return 0===sbHelpers.getMobileOS()&&sbHelpers.hasAnyClass(this,[cardProps.premiumCardClass])&&r.children().first().triggerHandler("click"),void a.preventDefault();var o=a.target;if(sbCards.boolUseQuickLook&&r.data("boolUseQuickLook")&&!sbCards.shouldUseOfferModalInsteadOfFlyout(t.cardTypeId,t.trayId,t.integrationTypeID,t.isSuppressModal,t.earn)&&!t.isSuppressModal)sbCards.initQuickLook(),sbQuickLook.show(r,!0);else if(!sbHelpers.hasAnyClass(o,[cardProps.clickableCouponCodeContainerClass,cardProps.clickableCouponCodeClass,cardProps.shopListViewStoreDetailsCtaClass,cardProps.shopListViewStoreCouponsCtaClass,cardProps.shopListViewStoreMainCtaClass])){if(sbCards.isShopSearch||sbCards.isGlobalSearch){var i=sbCards.isShopSearch?sbCards.shopSearchCards:sbCards.globalSearchCards;t=sbCards.getCardData(i,r.data("cardId")),o.classList.contains("sbTrayListItemGoToCta")&&a.preventDefault()}else t=r.tmplItem().data;if(sbCards.trackGaDataForCardClicks(t,r,a),d)return void(t.isSuppressModal||(sbCards.handleOfferModal({cardData:t,event:a,redirectUrl:t.link}),a.preventDefault()));sbCards.shouldUseRclonFlowBehavior()&&sbCards.updateToRclonFlowBehavior(t),generateCardLink(t,o.classList.contains(cardProps.searchCardShopNowCtaClass),void 0,a)}}}else sbCards.initActivityWindow()})).delegate(".sbStarterCardCloseCta","click",(function(){sbHelpers.toggle(e(this).parent().addClass(cardProps.backgroundContentClass).next(),!0)})).delegate(".sbStarterCardCloseConfirmationCancelCta","click",(function(){var a=e(this).parent();a.prev().removeClass(cardProps.backgroundContentClass),sbHelpers.toggle(a,!1)})).delegate(".sbCardCloseCta","click",(function(){handleCloseCard(e(this).tmplItem().data)})),sbCards.shouldUseFlyout=function(e){if(!t||sbCards.shouldUseOfferModalInsteadOfFlyout(e.data("cardTypeId"),e.data("trayId"),e.data("integrationTypeID"),e.data("isSuppressModal"),e.data("earn")))return!1;if(sbCards.isGlobalSearch&&e[0]&&e[0].classList.contains("soResult"))return!1;if(e.length){var a=document.getElementById("sbCardsJson"),r=sbHelpers.getJsonScriptContent(a);return sbGlbl.isHome?sbHelpers.isNonEmptyString(e.data("disclaimer")):!(!sbHelpers.isObjectEmpty(r)&&r.shopHomepage||sbCards.isShopSearch)&&!sbHelpers.hasAnyClass(e[0],[cardProps.hiddenCardClass,"disableInfoTip",cardProps.cardListViewSelector,cardProps.toutCardClass,"sbCustomHomeCard",cardProps.premiumCardClass,cardProps.continuePlayingCardClass])}return!0}}(jQuery);var trialPayCards=function(){var e={offers:[],cardsWaiting:[]},a={init:function(){e.initCalled=!0,pLoadScript(trialPayApiCall)},onApiResponse:function(r){e.offers=r,e.responseReceived=!0,a.processAllWaitingCards(),setTimeout(a.sendOffersToServer,0)},sendOffersToServer:function(){if(e.offers.length){var r=[];$.each(e.offers,(function(e,t){r.push(a.createHashFromOffer(t))})),$.post("/?cmd=card-jx-trialpay",{offers:r.join()})}},createHashFromOffer:function(e){var r="";return e.category&&(e.category.sort(),$.each(e.category,(function(e,a){r+=a}))),MD5(e.id+a.stripNewlines(e.title)+a.stripNewlines(e.instructions)+e.vc_amount+r)},stripNewlines:function(e){return e.replace(/\r?\n/g," ")},onCard:function(r,t,s){e.initCalled||a.init(),e.responseReceived?a.processWaitingCard(s):e.cardsWaiting.push(s)},processAllWaitingCards:function(){$.each(e.cardsWaiting,(function(e,r){a.processWaitingCard(r)}))},processWaitingCard:function(r){var t;$.each(e.offers,(function(e,a){if(a.id===r.offerID)return t=a,!1})),t?a.populateCardFromOffer(r,t):disableCard(r.$card)},populateCardFromOffer:function(e,a){var r=e.$card;r.data({header:a.title,subHeader:stripHtml(a.instructions)+' Click <a target="_blank" href="'+a.help+'">here</a> for help.',earn:a.vc_amount,link:a.link}),$.extend(r.tmplItem().data,r.data()),r.find(".cardHeader").html(a.title),sbCards.asyncUpdatePayout(cardId,a.vc_amount);var t=r.find("."+cardProps.cardImgContainerSelector),s=a.image2_url;s||(t.addClass("trialPaySecondaryImg"),s=a.image_url),t.css("backgroundImage","url("+s+")"),e.$card.removeClass(cardProps.hiddenCardClass)}};return{callback:a.onApiResponse,onCard:a.onCard}}();sbCards.getTrayProperties=function(e){"use strict";return Trays.get(e)||streams.filter((function(a){if(!a)return!1;var r=a.streamID;return Number.isInteger(r)&&r===e}))[0]},sbCards.getTrayCards=function(e){"use strict";return e.items||e.cards},sbCards.getTrayRowsCount=function(e){"use strict";if(!e||"undefined"==typeof Trays||!Trays)return-1;var a=Trays[e.data().trayId];return"object"!=typeof a?-1:a.rows||-1},sbCards.extendFlyoutDataWithFormattedValues=function(e){return e.earn&&(e=$.extend(e,{earnFormatted:sbHelpers.formatNumbersWithCommas(e.earn)})),e.origEarn&&(e=$.extend(e,{origEarnFormatted:sbHelpers.formatNumbersWithCommas(e.origEarn)})),e},sbCards.extendLinkWithTrayId=function(e){if("play"===sbPage.strChannelName){var a=e.link;sbHelpers.isMember()&&sbHelpers.isNonEmptyString(a)&&e.trayId===sbCards.objTrays.swagbucksGames&&(e.link=sbHelpers.updateQueryString("tid",sbCards.objTrays.swagbucksGames,a))}return e},sbCards.extendDataCtaPropText=function(e,a){return e.cta&&(e=$.extend(e,{cta:a})),e},sbCards.getCardData=function(e,a){"use strict";var r=$.grep(e,(function(e){return e.cardId==a}));return r.length?r[0]:{}},sbCards.getTrayId=function(e){return specificStream?initialCardLoad.streamID:Number(sbCards.getTray(e).attr("id").replace(cardProps.traySelector,""))},sbCards.getTray=function(e){if(e instanceof jQuery)return e.closest("."+cardProps.traySelector);throw new Error("Unable to get tray: Invalid $card.")},sbCards.generateCardClickUrl=function(e,a){var r=e.trkId,t=e.extraParms;return sbHelpers.isNonEmptyString(r)&&e.cardTypeId===cardProps.intNtfCardTypeId&&sbHelpers.isNonEmptyString(t)&&(r+=t),sbHelpers.updateQueryString({card_id:e.realCardId,pos:getRealCardPos(getCardById(e.cardId)),card_type:e.cardTypeId,trayId:e.trayId,trkId:r,link:encodeURIComponent(decodeURIComponent(a))+(e.appendAfterLink||"")},"/?cmd=card-click")},sbCards.generateCardLink=generateCardLink,sbCards.setCaptionLines=function(e){return sbHelpers.isObjectEmpty(e)||(e.boolIsShopCard&&e.origEarn<e.earn||e.boolIsWatchCard||e.surveyID>0||e.cardTypeId===cardProps.intLocalDealCardTypeId?e.captionLines=1:e.captionLines=2),e},sbCards.insertTrayCallout=function(e){var a="sbTrayCallout",r=document.querySelector("#cardDeck #sbTrayCallout");if(sbGlbl.isHome&&sbHelpers.isNonEmptyString(e)&&!r){var t=document.getElementById(a),s=document.getElementsByClassName(e);t&&s.length&&(s[0].appendChild(t),t.classList.remove("sbTrayCalloutHidden"))}},function(){"use strict";var e;function a(e){return e.name}sbCards.addTrayCardsViewedMetadata=function(){if(e)return e;for(var a={url:window.location.href,specificStream:specificStream},r=["intPageId","isAppm","isMobile","boolIsMember","streamsMetadata"],t=r.length,s=0;s<t;s++){var d=r[s];d in sbGlbl&&(a[d]=sbGlbl[d])}return"location"in sbGlbl&&"id"in sbGlbl.location&&(a.location=sbGlbl.location.id),e=a,a},sbCards.changeAmazonCardLinks=function(e){var a=e.trayId==sbCards.objTrays.amazonStoreUS?cardProps.intAmazonUsMerchantId:cardProps.intAmazonCaMerchantId,r=sbHelpers.updateQueryString("merchant",a,"/g/shopredir"),t="";a==cardProps.intAmazonUsMerchantId&&(t="swagbucks0f-20"),r=sbHelpers.updateQueryString("tag",t,r),r=sbHelpers.updateQueryString("trkid",e.trkId,r),r=sbHelpers.updateQueryString("page",-1,r);for(var s=0;s<e.subCategories.length;s++){var d=r,o=e.subCategories[s];o.link=sbHelpers.updateQueryString("linkID",o.linkID||"",d)}e.link=sbHelpers.updateQueryString("linkID",e.linkID||"",r)},sbCards.changeAmazonCardSubheader=function(e){"subCategories"in e&&e.subCategories.length&&(e.subHeader=e.subCategories.map(a).join(", "))}}();