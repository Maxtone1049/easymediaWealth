sbGlbl.sbHomePremiumBanner=function(){var r={impressionScriptFired:[],$cardWrapper:$("#cardDeck"),$premiumWrap:{},$curBanner:null,bannerHtmlCache:{},bannerJSONCache:{},premiumBannersArr:[],curTrayId:-1,strHeaderName:"Featured",strAboutHeading:"About Offer",strCta:"View Offer"},e=$.template('<section class="premiumBanner featuredCard toutLikeCard{{if typeof disclaimer !== "undefined" && disclaimer}} withTerms{{/if}}" data-ntf-id="{{html id}}"><header id="sbTrayListItemHeader{{html cardId}}-{{html trayId}}" class="sbTrayListItemHeader"><div class="sbTrayListItemHeaderImgContainerWrapper"><img id="sbTrayListItemHeaderImgContainer{{html cardId}}-{{html trayId}}" class="sbTrayListItemHeaderImgContainer" loading="lazy" alt="{{html header}}" src="{{if typeof pImageId !== "undefined" && pImageId > 0}}'+pImagePath+"{{html image}}?v={{html getImgVersion( cardId || id )}}{{else}}"+sbHelpers.getExternalContentPath("NOTIFICATIONS_PREMIUM_BANNER")+'/premiumBanner{{html cardId || id}}.jpg?v={{html getImgVersion( cardId || id )}}{{/if}}"></div><p id="cardHeader{{html cardId}}-{{html trayId}}" class="sbTrayListItemHeaderCaption cardHeader" data-notranslate>{{html header}}</p></header><p class="sbTrayListItemSbContainer">{{if earn}}<span class="sbTrayListItemSbEarn sbPrimaryColor" id="cardSBValue{{html cardId}}-{{html trayId}}">Earn <span id="cardSBValueAmt{{html cardId}}-{{html trayId}}">{{if upTo}}up to {{/if}}<var>{{html earn}} SB</var></span>{{html sbCards.getPerCurrencyPayoutMarkup( this.data.perDollar, 1 )}}{{else}}&nbsp;{{/if}}</p><span id="cardTypeName{{html cardId}}-{{html trayId}}" class="sbTrayListItemSbType">'+r.strHeaderName+"</span></section>");return{buildHTML:function(r,a){return $.tmpl(e,a)},createBannersHTML:function(e,a){r.$premiumWrap[r.curTrayId].addClass("showPremiumBanner");for(var n=0,t=r.premiumBannersArr.length;n<t;n++){var d=r.premiumBannersArr[n];d.id<0&&void 0===d.trayId||("string"==typeof a&&""!==a&&(d.strChannel=a),this.appendSingleBanner(d,e))}},appendSingleBanner:function(e,a){var n=r.curTrayId;r.bannerJSONCache[n][e.id]=e;var t=sbGlbl.getCardsLocation(),d={specialTerms:e.disclaimer,realCardId:e.cardId,cardId:(sbHelpers.isNumeric(e.id)?Math.abs(e.id):e.id)+"-"+n,boolIsCardTypeIdNumeric:!1,boolIsShopCard:!1,boolIsShopCardSwagUpPromo:!1,boolIsWatchCard:!1,boolIsNcraveCard:!1,hasNcraveEarnAmountShown:!1,hasNcraveTrayRedesign:!1,boolIsAnswerCard:!1,boolIsAnswerCardBonus:!1,boolIsAnswerCardPromo:!1,boolIsAnswerCardBonusExpiration:!1,boolUseQuickLook:"Discover"===e.strChannel,aboutHeading:r.strAboutHeading,currentLocationId:t.locationID,currencySymbol:t.currencySymbol,currencyName:t.currencyName.toLowerCase(),cta:r.strCta};a&&$.extend(d,{perDollar:e.link.indexOf("shopredir")>=0}),!0===e.perDollar&&e.earn&&(e.cashBackPercent=sbCards.calculateCashBackPercent(e.earn)),e=sbCards.setCaptionLines(e);var i=r.$premiumWrap[n];e=$.extend({},e,d),$.extend(i.tmplItem().data,e);var s=e.link.replace(/@MemberID@/g,sbGlbMember).replace("tag=","ntfCmd="+premiumBannerProps.ntfCmd+"&mid="+sbGlbMember+"&tag="),c=e.cardTypeID&&e.id<0?"/?cmd=card-click&card_id="+e.realCardId+"&pos="+getRealCardPos(r.$premiumWrap[r.curTrayId])+"&card_type="+e.cardTypeId+"&trkId="+e.trkId+"&link="+encodeURIComponent(decodeURIComponent(s))+(e.appendAfterLink||""):s;$.extend(e,{featuredOrPremiumFinalTargetUrl:c}),r.bannerHtmlCache[n].push(this.buildHTML(e.id,e).data(e).appendTo(i).bind("click",(function(r){var a=$(this);r.preventDefault(),sbHelpers.hasAnyClass(r.target,["active"])||(sbCards.boolUseQuickLook&&a.data("boolUseQuickLook")?sbQuickLook.show(a.parent(),!0):sbHelpers.isMember()?e.targetBlank?window.open(c).focus():window.location=c:(sbCards.redirectOnCardClick(e.cardTypeId,c),$cardInfoTipWrap.hide()))})).find(".cardClose:first").die("click").bind("click",(function(r){r.stopImmediatePropagation(),sbGlbl.sbHomePremiumBanner.closeBanner(this,$(this).parents(".premiumBanner").attr("data-ntf-id"),e,n)})).end())},dropBannerPixel:function(){var e=r.$curBanner.attr("data-ntf-id"),a=r.bannerJSONCache[r.curTrayId][e],n=a.impressionScript;n&&n.length&&r.impressionScriptFired.indexOf(e)<0&&(r.impressionScriptFired.push(e),sbHelpers.isScriptUrl(n)?sbHelpers.injectImpressionScriptTag(n,a.cardId,r.$curBanner):$('<div class="isPixel" style="display: none;">'+n.replace(/@MemberID@/g,sbGlbMember)+"</div>").appendTo("body"))},setNextBanner:function(e,a){var n=r.bannerHtmlCache[a];return n.length||e?(e||(r.$curBanner=n.shift().fadeIn("fast")),this.dropBannerPixel(),this):(this.hideBannerWrap(a),this)},hideCurBanner:function(e,a){var n=e.parents(".premiumBanner");return sbGlbl.sbHome.animateCloseCard(n),1==r.bannerHtmlCache[a].length&&r.$premiumWrap[a].addClass("noPremiumBannersLeft"),this},hideBannerWrap:function(e){sbGlbl.sbHome.animateCloseCard(r.$premiumWrap[e])},createPremiumBanners:function(e,a,n,t){r.curTrayId=a,r.premiumBannersArr=e,r.$premiumWrap[a]=$('<section id="premiumBannerWrap'+r.curTrayId+'" class="premiumBannerWrap sbCard sbHomeCard doubleWideCard"></section>');var d=r.bannerHtmlCache[r.curTrayId]=[];return r.bannerJSONCache[r.curTrayId]=[],this.createBannersHTML(n,t),d.length>0?(r.$curBanner=d.shift().css("display","block"),this.setNextBanner(!0,a),r.$premiumWrap[a]):$()},closeBanner:function(r,e,a,n){var t=this,d=a.cardTypeID&&e<0?"/?cmd=card-jx-hide&card_id="+a.realCardId+"&trkId="+a.trkId:"/?cmd=co-ntfclosed&ntfCmd="+premiumBannerProps.ntfCmd+"&mid="+sbGlbMember+"&ntfID="+e;$.post(d,(function(e){"1"==e.charAt(0)&&t.hideCurBanner($(r),n).setNextBanner(!1,n)}))}}}();