if($(".hoverDetailsHeader").live("click",(function(e){var a=e.target;if(!$(a).hasClass("hoverDetailsHeaderFavoriteCta")){var t=$(this),i=t.parent().data(),r=a.classList.contains("hoverDetailsHeaderMainCta");if(sbCards.trackGaDataForCardClicks(i,t,e),!i.boolIsShopCard&&r)return;generateCardLink(i,r,!0,e)}})),$(".hoverDetailsVideoContainer").live("click",(function(e){var a=$(this),t=a.closest("article").data();sbCards.trackGaDataForCardClicks(t,a,e)})),$(".hoverDetailsSecondaryCta").live("click",(function(e){generateCardLink($(this).parent().parent().data(),!1,!0,e)})),$(".hoverDetailsInfoNavCta").live("click",(function(){var e=$(this);e.addClass("active").siblings().removeClass("active").closest(".hoverDetailsCard").find(".hoverDetailsInfo").hide(),$("#"+e.data("target")).show()})),$(".hoverDetailsHeaderFavoriteCta").live("click",(function(){var e=$(this);e.hasClass("notFavorite")?$.post("/?cmd=sh-jx-fav&type=add&id="+e.attr("data-id"),(function(a){"1"==a.substring(0)&&(e.removeClass("notFavorite").addClass("favorite"),$("#"+cardProps.traySelector+FAVORITES_TRAY).triggerHandler("cardAdded"),sbHelpers.trackData({eventCategory:"Member UX",eventAction:"Add To Favorites",eventLabel:e.attr("data-name")}))})):e.hasClass("favorite")&&$.post("/?cmd=sh-jx-fav&type=remove&id="+e.attr("data-id"),(function(a){if("1"==a.substring(0)){var t=e.closest(".hoverDetailsCard").data("realCardId"),i=createNewCardId(t,FAVORITES_TRAY),r=cardProps.cardId,o=cardProps.cardInfoTooltipWrapId,s=cardProps.cardInfoTooltipWrapClass;e.closest("."+s).data("trayId")===FAVORITES_TRAY&&$("#"+o).hide(),$("#"+o+i).remove(),$("."+s+t).find(".hoverDetailsHeaderFavoriteCta").removeClass("favorite").addClass("notFavorite"),$("."+r+t).data("favoriteStore",!1);var l=$("#"+r+i);if(l.length){hideCard(l,(function(){var e=$("#"+cardProps.traySelector+FAVORITES_TRAY);e.length?(e.triggerHandler("cardRemoved"),e.find("."+cardProps.cardClass).length||showNullCase(3,!0,e)):specificStream&&specificStream===FAVORITES_TRAY&&!$("#"+cardProps.cardsPageWrapperId).find("."+cardProps.cardClass).length&&showNullCase(3,!0)}))}sbHelpers.trackData({eventCategory:"Member UX",eventAction:"Remove From Favorites",eventLabel:e.attr("data-name")})}}))})),(void 0===sbCards.boolUseFlyout||sbCards.boolUseFlyout)&&addMouseHoverEvents($(".featuredCard")),sbCards.isGlobalSearch){var sbResultsListCards=$(".sbResultsList").find(".sbResultItem");addMouseHoverEvents(sbResultsListCards)}if(sbCards.isShopSearch){var sbShopSearchStoresCards=$("#sbShopSearchStores").find(".shopCard");addMouseHoverEvents(sbShopSearchStoresCards)}function addMouseHoverEvents(e){e.live("mouseenter",(function(){sbCards.shouldUseOfferModalInsteadOfFlyout($(this).data().cardTypeId,$(this).data().trayId,$(this).data().integrationTypeID,$(this).data().isSuppressModal,$(this).data().earn)||$(this).data().isSuppressModal||showCardInfo($(this))})).live("mouseleave",(function(){sbCards.shouldUseOfferModalInsteadOfFlyout($(this).data().cardTypeId,$(this).data().trayId,$(this).data().integrationTypeID,$(this).data().isSuppressModal,$(this).data().earn)||$(this).data().isSuppressModal||hideCardInfo($(this))}))}var curShowTipTimer,curHideTipTimer,cardHoverShowDelay=900,tipIsVisible=!1,cancelShowTipTimer=!1,cancelHideTipTimer=!1,tooltipLeftExtraOffset=7,tooltipTopExtraOffset=-2,subHeaderMaxHeight=0;function showTipForCard(e){if(!e.hasClass("hiddenCard")&&!e.hasClass("animateScaleRemove")){var a=$cardInfoTipWrap.data("curId"),t=addCardToTipsCacheOrAndReturnTmpl(e),i=e.data("cardId"),r=t.firstTime,o="#hoverDetails";$(".premiumBannerWrap");if($cardInfoTipWrap.data("curId")!=i){$cardInfoTipWrap.data("curId",i);var s=$(o+a),l=$(o+i);subHeaderMaxHeight||(subHeaderMaxHeight=parseInt($cardInfoTipWrap.find(".hoverDetailsDescSec:first").css("max-height")));var d=[{$elm:$("#cardSubHeader"+i),maxHeight:120,ignoreMaxHeightIfOnlyElm:!0},{$elm:$("#hoverDetailsActualTerms"+i),maxHeight:80}];if(sbCards.isGlobalSearch)if(!l.data("boolHasChangedTabsOrder")){var n=l.children(".hoverDetailsInfoNav"),h=n.children(".hoverDetailsInfoNavSubHeaderCta");if(h){var c=h.data("target");if(sbHelpers.isNonEmptyString(c)){var f=$("#"+c);if(f){h.remove().prependTo(n);var p=l.children(".hoverDetailsInfo");p.length>1&&f.insertBefore(p.first()),l.data("boolHasChangedTabsOrder",!0)}}}}tipIsVisible?($cardInfoTipWrap.removeClass("noAnimate"),$(".animateScaleUp:first").removeClass("animateScaleUp").addClass("animateScaleDown"),s.fadeOut({duration:0,queue:!1}).promise().done((function(){l.fadeIn({duration:10,queue:!1,complete:function(){$(o+i).find(".hoverDetailsInfoNavCta").removeClass("active").first().addClass("active"),r&&updateSubHeaderAndTermsSection.call(null,l,d),positionCardDataTip(e),reloadHoverDetailsTooltip()}})}))):($cardInfoTipWrap.addClass("noAnimate").show().children(o+i).show().promise().done((function(){var e=$(o+i);e.find(".hoverDetailsInfoNavCta").removeClass("active").first().addClass("active"),e.find(".hoverDetailsInfo").hide().first().show()})),r&&updateSubHeaderAndTermsSection.call(null,l,d),tipIsVisible=!0,positionCardDataTip(e)),e.removeClass("animateScaleDown").addClass("animateScaleUp"),r&&e.data("code")&&$("#couponCodeCopy"+i+",#couponCode"+i).live("click",(function(){var e={"data-tooltip-content":'Now press Control/Command and the letter "c" on your keyboard, to copy your code.',"data-tooltip-style":"dark"};$("#couponCode"+i).find(".actualCouponCode:first").replaceWith('<input value=" '+$.trim($("#couponCode"+i).text())+'" class="couponCodeCopyInput isTooltipTrigger"/>'),$(".couponCodeCopyInput").focus().select().attr(e),$(this).addClass("isTooltipTrigger").attr(e),reloadHoverDetailsTooltip(),$(this).trigger("mouseover")})),reloadHoverDetailsTooltip()}}}function updateSubHeaderAndTermsSection(){for(var e=Array.prototype.slice.call(arguments,0),a=e.shift(),t=e.shift(),i=t.length-1;i>=0;i--)setSectionShadowsAndMaxHeight(t[i],a)}function setSectionShadowsAndMaxHeight(e,a){var t=e.$elm;if(t.length){var i,r=e.maxHeight,o=(t.outerHeight(!0),t.height());t.height()>r&&!(e.ignoreMaxHeightIfOnlyElm&&$cardInfoTipWrap.outerHeight()<350&&t.height()<2*r)?(t.wrap('<div class="hoverDetailsWrap"></div>').parent().prepend('<div class="largeTextTop"></div>').append('<div class="largeTextBottom"></div>'),(i=t.css("max-height",r).parents(".hoverDetailsWrap")).find(".largeTextBottom").show(),t.bind("scroll",(function(){var e=o-$(this).scrollTop()==r;0==$(this).scrollTop()?i.find(".largeTextBottom").fadeIn("fast").siblings(".largeTextTop").fadeOut("fast"):$(this).scrollTop()>0&&!e?i.find(".largeTextTop").add(i.find(".largeTextBottom")).fadeIn("fast"):e&&i.find(".largeTextBottom").fadeOut("fast").siblings(".largeTextTop").fadeIn("fast")}))):t.css("max-height","none")}}function hideTipForCard(e){sbCards.shouldUseFlyout(e)&&($cardInfoTipWrap.hide().children("#hoverDetails"+$cardInfoTipWrap.data("curId")).hide(),$cardInfoTipWrap.data("curId","undefined"),tipIsVisible=!1,e&&e.length&&e.removeClass("animateScaleUp").addClass("animateScaleDown"))}function reloadHoverDetailsTooltip(){initNewTooltip({elm:"#"+$cardInfoTipWrap.attr("id")})}function positionCardDataTip(e){for(var a=$cardInfoTipWrap.attr("class").split(" "),t=a.length-1;t>=0;t--)a[t].indexOf("hovertip")>-1&&a.splice(t,1);var i=$cardInfoTipWrap.outerWidth(),r=$cardInfoTipWrap.outerHeight(),o=Math.ceil(e.offset().left),s=Math.ceil(e.offset().top),l=e.outerWidth(),d=e.outerHeight(!0),n=(e.width(),e.height()),h=$(window),c=h.width(),f=h.height(),p=h.scrollTop(),v=o-(i+tooltipLeftExtraOffset),m=s+tooltipTopExtraOffset,u=getTopBarHeight(),C=p+u,T=f+p,D=r>T-s,I=r>s-C,b=elmIsBelowTheFold(e),g=elmIsAboveTheTop(e);if(c<960)g||I?(m=s+d+tooltipLeftExtraOffset,v=o+(l-i)/2,a.push("hovertiptop")):(m=s-r-tooltipLeftExtraOffset,v=o+(l-i)/2,a.push("hovertipdown"));else if(o+l/2<c/2?(v=o+l+tooltipLeftExtraOffset,a.push("hovertipleft")):a.push("hovertipright"),D)m=T-r,b?a.push("hovertipLeftOrRightBottom","hovertipLeftOrRightBottomLower"):!elmIsBelowTheFold(e,-100)&&s-n<m-r||a.push("hovertipLeftOrRightBottom");else if(b)m=T-(r+tooltipTopExtraOffset),a.push("hovertipLeftOrRightBottom");else if(g){var y=h.scrollTop()-s-u>-2*tooltipTopExtraOffset;m=C+(y?0:tooltipTopExtraOffset),y&&a.push("hovertipLeftOrRightTopUpper")}$cardInfoTipWrap.css({left:v,top:m}).removeClass().addClass(a.join(" "))}function showCardInfo(e){sbCards.shouldUseFlyout(e)&&(clearTimeout(curShowTipTimer),cardHoverShowDelay=500,cancelShowTipTimer=!1,curShowTipTimer=setTimeout((function(){cancelShowTipTimer||showTipForCard(e)}),cardHoverShowDelay))}function hideCardInfo(e){e=e||$(".animateScaleUp");sbCards.shouldUseFlyout(e)&&(cancelShowTipTimer=!0,cancelHideTipTimer=!1,curHideTipTimer=setTimeout((function(){cancelHideTipTimer||hideTipForCard(e)}),370))}$("#hoverDetails").length||($cardInfoTipWrap=$('<aside id="hoverDetails" class="hoverDetails"></aside>').appendTo("body"),$cardInfoTipWrap.hover((function(){cancelHideTipTimer=!0}),(function(){hideCardInfo(),cancelHideTipTimer=!1})));var hoverDetailsTmpl=$.template('<article id="hoverDetails{{html cardId}}" class="hoverDetailsCard{{html realCardId}} hoverDetailsCard hoverDetailsCardType{{if typeof cardTypeId === "number"}}{{html cardTypeId}}{{/if}}"><header class="hoverDetailsHeader" role="button" tabindex="0"><h1 id="hoverDetailsHeaderTitle{{html cardId}}" class="hoverDetailsHeaderTitle" data-notranslate>{{html header}}</h1>{{if boolIsWatchCard}}<p id="sbCardDetailsHeaderExplainPlaylistReward{{html cardId}}" class="sbTrayListItemTimeContainer timeOnDetails" data-notranslate>{{if typeof durationTime === "string" && durationTime != "0:00"}}{{html durationTime}}{{/if}}</p>{{/if}}<h2 id="hoverDetailsHeaderSb{{html cardId}}" class="hoverDetailsHeaderSb">{{if $data.earn && $data.earn > 0 || ($data.boolIsWatchCard && $data.earnLoc && $data.earnLoc > 0)}}{{if typeof origEarn !== "undefined" && origEarn != earn}}<del class="hoverDetailsHeaderSbOrigEarn sbOrigEarn">{{if upTo}}Up to {{/if}}<var>{{html origEarnFormatted}} SB</var>{{html sbCards.getPerCurrencyPayoutMarkup( this.data.perDollar, 1 )}}</del><ins class="hoverDetailsHeaderSbEarn sbBgPrimaryColor{{if upTo}}{{if perDollar}} hoverDetailsHeaderUpTo{{/if}}{{/if}}">{{if upTo}}Up to {{/if}}<var>{{html earnFormatted}} SB</var> {{html sbCards.getPerCurrencyPayoutMarkup( this.data.favoriteShopCard, 10, "/" )}}{{html sbCards.getPerCurrencyPayoutMarkup( this.data.perDollar, 1 )}}</ins>{{else}}<span class="hoverDetailsHeaderSbEarn sbBgPrimaryColor{{if upTo}}{{if perDollar}} hoverDetailsHeaderUpTo{{/if}}{{/if}}">{{if upTo}}Up to {{/if}}<var>{{if boolIsWatchCard && $data.earnLoc}}{{html earnLoc}}{{else}}{{html earnFormatted}}{{/if}} SB</var> {{html sbCards.getPerCurrencyPayoutMarkup( this.data.favoriteShopCard, 10, "/" )}}{{html sbCards.getPerCurrencyPayoutMarkup( this.data.perDollar, 1 )}}</span>{{/if}}</h2>{{else}}<span class="hoverDetailsHeaderSbEarn">&nbsp;</span>{{/if}}</h2>{{if cta && typeof cardTypeId == "undefined" }}<a href="{{html link}}" target="_blank" class="hoverDetailsHeaderMainCta sbCta sbPrimaryColor{{if upTo}}{{if perDollar}} hoverDetailsHeaderUpToCta{{/if}}{{/if}}">{{html cta}}</a>{{/if}}{{if typeof favoriteStore === "boolean"}}<button class="hoverDetailsHeaderFavoriteCta sbCta {{if !favoriteStore}}notF{{else}}f{{/if}}avorite" data-id="{{html merchantId}}" data-name="{{html header}}">Favorite</button>{{/if}}{{if $data.earn && $data.earn > 0}}{{if perDollar}}<p id="hoverDetailsHeaderSbPerOneDollarExplain{{html cardId}}" class="hoverDetailsHeaderSbPerOneDollarExplain">Earn {{if upTo}}up to {{/if}}<var>{{html earnFormatted}} SB</var> for every {{html currencyName}} you spend</p><p id="hoverDetailsHeaderSbPerOneDollarExplainCashBack{{html cardId}}" class="hoverDetailsHeaderSbPerOneDollarExplainCashBack">That\'s {{if upTo}}up to {{/if}}<var>{{html cashBackPercent}}%</var> Cash Back!</p>{{/if}}{{/if}}{{if (hasNcraveTrayRedesign && $data.earn) || (boolIsWatchCard && ($data.earn || $data.earnLoc))}}<p id="hoverDetailsHeaderExplainReward{{html cardId}}" class="hoverDetailsHeaderExplainReward">{{if boolIsWatchCard}}Watch this playlist of <var>{{html playlistSize}}</var> video{{else boolIsNcraveCard}}{{html sbCards.nCraveActivities[linkType] + " " + (size > 0 ? size : "?") + " " + linkType}}{{/if}}{{if size != 1}}s{{/if}} and earn <var>{{if boolIsWatchCard && $data.earnLoc}}{{html earnLoc}}{{else}}{{html earnFormatted}}{{/if}} SB</var></p>{{/if}}</header>{{if typeof timeComplete !== "undefined" && timeComplete > 0}}<aside class="hoverDetailsInfoTimeToComplete"><span class="hoverDetailsInfoTimeToCompleteCopy"><var>{{html timeComplete}}</var> min</span> or less to complete</aside>{{/if}}{{if typeof subHeader !== "undefined" || typeof terms === "object" || typeof couponDescription === "string" || typeof specialConditions === "string" || typeof disclaimer === "string"}}<aside class="hoverDetailsInfoNav">{{if typeof terms === "object" && Object.keys( terms ).length || typeof specialConditions === "string" && specialConditions !== "" || typeof subCategories === "object" && subCategories.length}}<button class="hoverDetailsInfoNavCta sbCta hoverDetailsInfoNavSpecialTermsCta" data-target="hoverDetailsInfoSpecialTerms{{html cardId}}">Special Terms</button>{{/if}}{{if typeof couponDescription === "string" && couponDescription !== ""}}<button class="hoverDetailsInfoNavCta sbCta hoverDetailsInfoNavSubHeaderCta" data-target="hoverDetailsInfoCouponDescription{{html cardId}}">Special Terms</button>{{/if}}{{if boolIsCardTypeIdNumeric}}{{if boolIsWatchCard && typeof size === "number" && size > 0}}<button class="hoverDetailsInfoNavCta sbCta hoverDetailsInfoNavSubHeaderCta" data-target="hoverDetailsInfoWatchPlaylist{{html cardId}}">Playlist</button>{{/if}}{{/if}}{{if typeof subHeader !== "undefined" && subHeader}}<button class="hoverDetailsInfoNavCta sbCta hoverDetailsInfoNavSubHeaderCta" data-target="hoverDetailsInfoSubHeader{{html cardId}}">{{html aboutHeading}}</button>{{/if}}{{if typeof disclaimer === "string" && disclaimer !== ""}}<button class="hoverDetailsInfoNavCta sbCta hoverDetailsInfoNavSubHeaderCta" data-target="hoverDetailsInfoDisclaimer{{html cardId}}">Disclaimer</button>{{/if}}</aside>{{/if}}{{if typeof terms === "object" && Object.keys( terms ).length || typeof specialConditions === "string" && specialConditions !== "" || typeof subCategories === "object" && subCategories.length}}<section id="hoverDetailsInfoSpecialTerms{{html cardId}}" class="hoverDetailsInfo"><h1 class="hoverDetailsInfoHeading">Special Terms</h1>{{if typeof subCategories === "object" && subCategories.length}}<nav class="hoverDetailsInfoSubCategories">{{each subCategories}}<a href="{{html this.link}}" class="hoverDetailsInfoSubCategory" target="_blank" rel="nofollow">{{html this.name}}</a>{{/each}}</nav>{{/if}}{{if typeof terms !== "undefined" && Object.keys( terms ).length}}{{if typeof terms[ 2 ] !== "undefined" && terms[ 2 ]}}{{each terms[ 2 ]}}<p class="hoverDetailsInfoDetails" data-notranslate>{{html this.term}}</p>{{/each}}{{/if}}{{/if}}{{if typeof specialConditions === "string" && specialConditions !== ""}}<p class="hoverDetailsInfoDetails">{{if typeof specialConditions === "string" && specialConditions !== "" && typeof cardTypeId === "undefined" }}<span class="hoverDetailsInfoDetailsExcludes">Excludes: </span>{{/if}}<var>{{html specialConditions}}</var></p>{{/if}}</section>{{/if}}{{if typeof couponDescription === "string" && couponDescription !== ""}}<section id="hoverDetailsInfoCouponDescription{{html cardId}}" class="hoverDetailsInfo"><h1 class="hoverDetailsInfoHeading">Special Terms</h1><p class="hoverDetailsInfoDetails" data-notranslate>{{html couponDescription}}</p></section>{{/if}}{{if boolIsWatchCard && typeof size === "number" && size > 0}}<ul id="hoverDetailsInfoWatchPlaylist{{html cardId}}" class="hoverDetailsInfo hoverDetailsPlaylist">{{each videos}}<li class="hoverDetailsVideoContainer{{if $index < size}} hasBorder{{/if}}" title="{{html this.title}}"><a class="hoverDetailsVideoLink" href="{{html this.url}}"><div class="hoverDetailsVideoImage" style="background: url({{html decodeURIComponent(this.thumbnail)}}) no-repeat;"></div><div class="hoverDetailsInfoDetails hoverDetailsVideoInfo withEllipsis" data-notranslate>{{html this.title}}<br/><span class="hoverDetailsTime">{{if typeof this.durationTime === "string" && this.durationTime != "0:00"}}{{html this.durationTime}}{{/if}}</span><div class="hoverDetailsVideoRating sbRating{{html (Math.round(this.rating * 2) / 2).toFixed(1) * 10}}"></div></div></a></li>{{/each}}</ul>{{/if}}{{if typeof subHeader !== "undefined" && subHeader}}<section id="hoverDetailsInfoSubHeader{{html cardId}}" class="hoverDetailsInfo"><h1 class="hoverDetailsInfoHeading">{{html aboutHeading}}</h1><p class="hoverDetailsInfoDetails" data-notranslate>{{html subHeader}}</p></section>{{/if}}{{if $data.disclaimer || $data.appendToDisclaimer}}<section id="hoverDetailsInfoDisclaimer{{html cardId}}" class="hoverDetailsInfo"><h1 class="hoverDetailsInfoHeading">Disclaimer</h1><p class="hoverDetailsInfoDetails" data-notranslate>{{if $data.disclaimer}}{{html $data.disclaimer}}{{/if}}{{if $data.disclaimer && $data.appendToDisclaimer}} {{/if}}{{if $data.appendToDisclaimer}}{{html appendToDisclaimer}}{{/if}}</p></section>{{/if}}{{if offer}}<aside><p class="hoverDetailsOfferId">Offer ID: <var>{{html offer}}</var></p></aside>{{/if}}{{if typeof cardTypeId === "number" && cardTypeId === 39}}<aside class="hoverDetailsSecondaryCtaContainer"><button class="hoverDetailsSecondaryCta sbCta">See all offers from <var>{{html header}}</var></button></aside>{{/if}}</article>');